webpackJsonp([46],{"+0tb":function(t,e){},"/4c6":function(t,e){},"/bvW":function(t,e){},0:function(t,e){},"0Ab7":function(t,e){},"1+V2":function(t,e){},"36P2":function(t,e){},"3twD":function(t,e){},"4+hh":function(t,e){},"48Vo":function(t,e){},"4QwR":function(t,e){},"4S+S":function(t,e){},"5b78":function(t,e){},"5iz/":function(t,e){},"6+7q":function(t,e){},"799O":function(t,e){},"8V7z":function(t,e){},"9RcE":function(t,e,n){"use strict";var i=n("stWb");n.n(i).a},"9Won":function(t,e){},"9ndC":function(t,e){},B1y5:function(t,e){},BL7w:function(t,e){},C8ew:function(t,e){},CSik:function(t,e,n){"use strict";var i=n("ysfb");n.n(i).a},CYKL:function(t,e){},ClZn:function(t,e){},DCqN:function(t,e){},DcjM:function(t,e){},E1pZ:function(t,e){},HWhN:function(t,e){},JKLp:function(t,e){},KH4f:function(t,e){},"LAj/":function(t,e,n){"use strict";var i=n("XdyD");n.n(i).a},LhRv:function(t,e){},MlOf:function(t,e){},Mxm6:function(t,e){},NHnr:function(t,n,i){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o=i("7+uW"),a=i("/ocq"),r={name:"home",data:function(){return{showDialog:!1}},created:function(){this.router=this.$root.$data.router,this.store=this.$root.$data.store,this.api=this.$root.$data.store.api},mounted:function(){this.$nextTick(function(){})},methods:{}},s=(i("tSky"),i("K1/g")),l=Object(s.a)(r,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"home"},[n("md-app-toolbar",{staticClass:"md-primary"},[n("div",{staticClass:"md-toolbar-row",attrs:{flex:""}},[n("navbar")],1)]),t._v(" "),n("div",{staticClass:"md-toolbar-row md-layout md-alignment-center-center"},[n("div",{staticClass:"banner-container"},[n("img",{attrs:{src:"static/img/perspective-hr.jpg",alt:"banner"}}),t._v(" "),n("div",{staticClass:"subtitle"},[t._v("Image processing with joy!"),n("br"),t._v(" "),n("md-button",{staticClass:"md-raised ",attrs:{to:"app"}},[t._v("Start ImJoy üòÅ")])],1)])]),t._v(" "),n("br"),t._v(" "),n("md-dialog",{attrs:{"md-active":t.showDialog},on:{"update:mdActive":function(e){t.showDialog=e}}},[n("md-dialog-title",[t._v("Getting Started with ImJoy")]),t._v(" "),n("md-dialog-content",[n("p",[t._v("With the ImJoy web app, you process your images within the browser, instantly, no installation.")]),t._v(" "),n("md-button",{staticClass:"md-raised md-primary",attrs:{to:"app"}},[t._v("Start")]),t._v(" "),n("p",[t._v("You can process your data with the Imjoy app locally and anonymously, by default, no data will be transferred to the internet (also depends on the plugin you installed).")])],1),t._v(" "),n("md-dialog-actions",[n("md-button",{staticClass:"md-primary",on:{click:function(e){t.showDialog=!1}}},[t._v("OK")])],1)],1),t._v(" "),n("br"),t._v(" "),n("plugin-list",{attrs:{display:"card","config-url":"https://raw.githubusercontent.com/oeway/ImJoy-Plugins/master/manifest.json",title:"Plugins"}}),t._v(" "),n("br"),t._v(" "),n("md-divider"),t._v(" "),n("main-footer")],1)},[],!1,null,"fdbf9f58",null);l.options.__file="Home.vue";var c=l.exports,d=i("fZjL"),u=i.n(d),p=i("pFYg"),m=i.n(p),h=i("d7EF"),f=i.n(h),v=i("mvHQ"),g=i.n(v),_=i("Xxa5"),w=i.n(_),y=i("exGp"),b=i.n(y),k=i("BO1k"),C=i.n(k),x=i("//Fk"),P=i.n(x),j=i("woOf"),D=i.n(j),E=i("mtWM"),S=i.n(E),$=i("kkYf"),O=i.n($),I=["env","requirements","dependencies","icon","ui","mode"],W=O()({_id:[null,String],name:String,code:String,lang:[null,String],script:[null,String]}),A=O()({name:String,type:String,tags:Array,ui:[null,String],inputs:[null,Object],outputs:[null,Object]}),T=O()({name:String,type:String,config:Object,data:[null,Object],panel:[null,Object]}),U=(String,String,String,Array,String,Object,Object,new RegExp(/[-a-zA-Z0-9@:%_\+.~#?&//=]{2,256}\.[a-z]{2,4}\b(\/[-a-zA-Z0-9@:%_\+.~#?&//=]*)?/gi));function R(t,e,n){var i;return function(){var o=this,a=arguments,r=n&&!i;clearTimeout(i),i=setTimeout(function(){i=null,n||t.apply(o,a)},e),r&&t.apply(o,a)}}function L(){return Math.random().toString(36).substr(2,10)}function N(t){if(!t)return t;var e,n,i;for(i in e=Array.isArray(t)?[]:{},t)n=t[i],e[i]="object"===(void 0===n?"undefined":m()(n))?N(n):n;return e}var M=i("OvRC"),F=i.n(M),z=i("u2KI"),B=/\r?\n/g,J=/^\s*$/,V=/^(\r?\n)*[\t\s]/,q=function(t){if(!V.test(t))return t;for(var e,n,i,o=t.split(B),a=1/0,r=0;r<o.length;r++){var s=o[r];if(!J.test(s))if(e)(n=H(s,e))<a&&(a=n);else{if(" "!==(i=s.charAt(0))&&"\t"!==i)return t;(n=H(s,e=i))<a&&(a=n)}}return o.map(function(t){return t.slice(a)}).join("\n")};function H(t,e){for(var n=0;t.charAt(n)===e;)n++;return n}i.n(z)()({});Object.prototype.toString;function K(t,e){for(var n=F()(null),i=t.split(","),o=0;o<i.length;o++)n[i[o]]=!0;return e?function(t){return n[t.toLowerCase()]}:function(t){return n[t]}}K("slot,component",!0),K("key,ref,slot,slot-scope,is");Object.prototype.hasOwnProperty;var X,Y,G=/-(\w)/g;X=function(t){return t.replace(G,function(t,e){return e?e.toUpperCase():""})},Y=F()(null);Function.prototype.bind;var Z=function(t,e,n){return!1};K("area,base,br,col,embed,frame,hr,img,input,isindex,keygen,link,meta,param,source,track,wbr"),K("colgroup,dd,dt,li,options,p,td,tfoot,th,thead,tr,source");var Q=K("address,article,aside,base,blockquote,body,caption,col,colgroup,dd,details,dialog,div,dl,dt,fieldset,figcaption,figure,footer,form,h1,h2,h3,h4,h5,h6,head,header,hgroup,hr,html,legend,li,menuitem,meta,optgroup,option,param,rp,rt,source,style,summary,tbody,td,tfoot,th,thead,title,tr,track"),tt=/^\s*([^\s"'<>\/=]+)(?:\s*(=)\s*(?:"([^"]*)"+|'([^']*)'+|([^\s"'=<>`]+)))?/,et="[a-zA-Z_][\\w\\-\\.]*",nt="((?:"+et+"\\:)?"+et+")",it=new RegExp("^<"+nt),ot=/^\s*(\/?)>/,at=new RegExp("^<\\/"+nt+"[^>]*>"),rt=/^<!DOCTYPE [^>]+>/i,st=/^<!\--/,lt=/^<!\[/,ct=!1;"x".replace(/x(.)?/g,function(t,e){ct=""===e});var dt=K("script,style,textarea",!0),ut={},pt={"&lt;":"<","&gt;":">","&quot;":'"',"&amp;":"&","&#10;":"\n","&#9;":"\t"},mt=/&(?:lt|gt|quot|amp);/g,ht=/&(?:lt|gt|quot|amp|#10|#9);/g,ft=K("pre,textarea",!0),vt=function(t,e){return t&&ft(t)&&"\n"===e[0]};function gt(t,e){var n=e?ht:mt;return t.replace(n,function(t){return pt[t]})}var _t=/\r?\n/g,wt=/./g;K("script,style,template",!0);function yt(t,e){void 0===e&&(e={});var n={script:[],style:[],config:[],window:[],docs:[],attachment:[],link:[],others:[]},i=0,o=null;return function(t,e){for(var n,i,o=[],a=e.expectHTML,r=e.isUnaryTag||Z,s=e.canBeLeftOpenTag||Z,l=0;t;){if(n=t,i&&dt(i)){var c=0,d=i.toLowerCase(),u=ut[d]||(ut[d]=new RegExp("([\\s\\S]*?)(</"+d+"[^>]*>)","i")),p=t.replace(u,function(t,n,i){return c=i.length,dt(d)||"noscript"===d||(n=n.replace(/<!\--([\s\S]*?)-->/g,"$1").replace(/<!\[CDATA\[([\s\S]*?)]]>/g,"$1")),vt(d,n)&&(n=n.slice(1)),e.chars&&e.chars(n),""});l+=t.length-p.length,t=p,j(d,l-c,l)}else{var m=t.indexOf("<");if(0===m){if(st.test(t)){var h=t.indexOf("--\x3e");if(h>=0){e.shouldKeepComment&&e.comment(t.substring(4,h)),C(h+3);continue}}if(lt.test(t)){var f=t.indexOf("]>");if(f>=0){C(f+2);continue}}var v=t.match(rt);if(v){C(v[0].length);continue}var g=t.match(at);if(g){var _=l;C(g[0].length),j(g[1],_,l);continue}var w=x();if(w){P(w),vt(i,t)&&C(1);continue}}var y=void 0,b=void 0,k=void 0;if(m>=0){for(b=t.slice(m);!(at.test(b)||it.test(b)||st.test(b)||lt.test(b)||(k=b.indexOf("<",1))<0);)m+=k,b=t.slice(m);y=t.substring(0,m),C(m)}m<0&&(y=t,t=""),e.chars&&y&&e.chars(y)}if(t===n){e.chars&&e.chars(t),!o.length&&e.warn&&e.warn('Mal-formatted tag at end of template: "'+t+'"');break}}function C(e){l+=e,t=t.substring(e)}function x(){var e=t.match(it);if(e){var n,i,o={tagName:e[1],attrs:[],start:l};for(C(e[0].length);!(n=t.match(ot))&&(i=t.match(tt));)C(i[0].length),o.attrs.push(i);if(n)return o.unarySlash=n[1],C(n[0].length),o.end=l,o}}function P(t){var n=t.tagName,l=t.unarySlash;a&&("p"===i&&Q(n)&&j(i),s(n)&&i===n&&j(n));for(var c=r(n)||!!l,d=t.attrs.length,u=new Array(d),p=0;p<d;p++){var m=t.attrs[p];ct&&-1===m[0].indexOf('""')&&(""===m[3]&&delete m[3],""===m[4]&&delete m[4],""===m[5]&&delete m[5]);var h=m[3]||m[4]||m[5]||"",f="a"===n&&"href"===m[1]?e.shouldDecodeNewlinesForHref:e.shouldDecodeNewlines;u[p]={name:m[1],value:gt(h,f)}}c||(o.push({tag:n,lowerCasedTag:n.toLowerCase(),attrs:u}),i=n),e.start&&e.start(n,u,c,t.start,t.end)}function j(t,n,a){var r,s;if(null==n&&(n=l),null==a&&(a=l),t&&(s=t.toLowerCase()),t)for(r=o.length-1;r>=0&&o[r].lowerCasedTag!==s;r--);else r=0;if(r>=0){for(var c=o.length-1;c>=r;c--)(c>r||!t)&&e.warn&&e.warn("tag <"+o[c].tag+"> has no matching end tag."),e.end&&e.end(o[c].tag,n,a);o.length=r,i=r&&o[r-1].tag}else"br"===s?e.start&&e.start(t,[],!0,n,a):"p"===s&&(e.start&&e.start(t,[],!1,n,a),e.end&&e.end(t,n,a))}j()}(t,{start:function(t,e,a,r,s){0===i&&(o={type:t,content:"",start:s,attrs:e.reduce(function(t,e){var n=e.name,i=e.value;return t[n]=i||!0,t},{})},n[t]?(function(t,e){for(var n=0;n<e.length;n++){var i=e[n];"lang"===i.name&&(t.lang=i.value),"scoped"===i.name&&(t.scoped=!0),"module"===i.name&&(t.module=i.value||!0),"src"===i.name&&(t.src=i.value)}}(o,e),n[t].push(o)):n.others.push(o)),a||i++},end:function(n,a,r){if(1===i&&o){o.end=a;var s=q(t.slice(o.start,o.end));"template"!==o.type&&e.pad&&(s=function(e,n){if("space"===n)return t.slice(0,e.start).replace(wt," ");var i=t.slice(0,e.start).split(_t).length,o="script"!==e.type||e.lang?"\n":"//\n";return Array(i).join(o)}(o,e.pad)+s),o.content=s,o=null}i--}}),n}var bt=i("DmT9"),kt=i.n(bt),Ct=i("M4fF"),xt=i.n(Ct),Pt=i("vTna"),jt={name:"imjoy",props:["title"],data:function(){return{workflow_expand:!1,file_select:null,folder_select:null,selected_file:null,selected_files:null,showPluginDialog:!1,showSettingsDialog:!1,showAddPluginDialog:!1,showRemoveConfirmation:!1,plugin_dialog_config:null,_plugin_dialog_promise:{},_plugin2_remove:null,init_plugin_url:null,init_plugin_search:null,show_plugin_templates:!0,loading:!1,progress:0,status_text:"",engine_status:"Disconnected",engine_connected:!1,engine_url:"http://localhost:8080",windows:[],active_windows:[],selected_workspace:null,connection_token:null,showTokenPrompt:!1,showPluginEngineInfo:!1,workspace_list:[],workflow_list:[],resumable_plugins:[],showWorkspaceDialog:!1,show_file_dialog:!1,plugins:null,registered:null,updating_workflow:!1,installed_plugins:[],available_plugins:[],plugin_api:null,plugin_context:null,plugin_loaded:!1,menuVisible:!0,snackbar_info:"",snackbar_duration:3e3,show_snackbar:!1}},watch:{menuVisible:function(){}},created:function(){var t=this;this.router=this.$root.$data.router,this.store=this.$root.$data.store,this.api=this.$root.$data.store.api,this.api.show=this.show,this.window_ids={},this.plugin_names=null,this.db=null,this.client_id=null,this.plugin_templates={"Webworker(Javascript)":'\n<docs>\nDescribe your plugin here.\n</docs>\n\n<config lang="json">\n{\n  "name": "Untitled Plugin",\n  "mode": "webworker",\n  "tags": ["op", "image"],\n  "ui": "UI for Untitled Plugin",\n  "version": "0.1.0",\n  "api_version": "0.1.0",\n  "url": "",\n  "description": "describe your plugin here.",\n  "icon": "extension",\n  "inputs": null,\n  "outputs": null,\n  "env": null,\n  "requirements": null,\n  "dependencies": []\n}\n</config>\n\n<script lang="javascript">\nclass UntitledPlugin {\n  async setup() {\n    //await importScripts("http://xxxx/xxx.js")\n  }\n\n  run(my) {\n    console.log(\'running in the plugin \', my)\n\n  }\n}\n\napi.export(new UntitledPlugin())\n<\/script>\n\n',"Iframe(Javascript)":'\n<docs lang="markdown">\nDescribe your plugin here.\n</docs>\n\n<config lang="json">\n{\n  "name": "Untitled Plugin",\n  "mode": "iframe",\n  "tags": ["op"],\n  "ui": "UI for Untitled Plugin",\n  "version": "0.1.0",\n  "api_version": "0.1.0",\n  "description": "describe your plugin here",\n  "icon": "extension",\n  "inputs": null,\n  "outputs": null,\n  "dependencies": []\n}\n</config>\n\n<script lang="javascript">\nclass UntitledPlugin {\n  async setup() {\n    //await importScripts("http://xxxx/xxx.js")\n  }\n\n  run(my) {\n    console.log(\'running in the plugin \', my)\n\n  }\n}\n\napi.export(new UntitledPlugin())\n<\/script>\n',"Window(Javascript and HTML)":'\n<docs lang="markdown">\nDescribe your plugin here.\n</docs>\n\n<config lang="json">\n{\n  "name": "Untitled Plugin",\n  "mode": "iframe",\n  "tags": ["op", "window"],\n  "ui": "UI for Untitled Plugin",\n  "version": "0.1.0",\n  "api_version": "0.1.0",\n  "description": "describe your plugin here.",\n  "icon": "extension",\n  "inputs": null,\n  "outputs": null,\n  "dependencies": []\n}\n</config>\n\n<script lang="javascript">\nclass UntitledPlugin {\n  async setup() {\n    //await importScripts("http://xxxx/xxx.js")\n  }\n\n  run(my) {\n    console.log(\'running in the plugin \', my)\n\n  }\n}\n\napi.export(new UntitledPlugin())\n<\/script>\n\n<window lang="html">\n  <div>\n    <p>\n    Hello World\n    </p>\n  </div>\n</window>\n\n<style lang="css">\n\n</style>\n',"PyWorker(Python)":'\n<docs lang="markdown">\nDescribe your plugin here.\n</docs>\n\n<config lang="json">\n{\n  "name": "Untitled Plugin",\n  "mode": "pyworker",\n  "version": "0.1.0",\n  "api_version": "0.1.1",\n  "description": "describe your plugin here.",\n  "tags": ["demo", "op"],\n  "ui": null,\n  "inputs": null,\n  "outputs": null,\n  "icon": null,\n  "env": null,\n  "requirements": [],\n  "dependencies": []\n}\n</config>\n\n<script lang="python">\nimport numpy as np\nclass PythonPlugin():\n    def setup(self):\n        print(\'setup in python\')\n\n    def run(self, my):\n        print(\'hello world.\')\n        return my\n\napi.export(PythonPlugin())\n<\/script>\n'},this.default_window_pos={i:0,x:0,y:0,w:5,h:5},this.new_workspace_name="",this.preload_main=["/static/tfjs/tfjs.js","https://rawgit.com/nicolaspanel/numjs/893016ec40e62eaaa126e1024dbe250aafb3014b/dist/numjs.min.js"],this.workflow_joy_config={expanded:!0,name:"Workflow",ui:"{id:'workflow', type:'ops'}"},window.onbeforeunload=function(t){return modified?"":null},window.addEventListener("dragover",function(t){t.preventDefault(),document.querySelector("#dropzone").style.visibility="",document.querySelector("#dropzone").style.opacity=1,document.querySelector("#textnode").style.fontSize="48px"}),window.addEventListener("dragenter",function(t){t.preventDefault(),document.querySelector("#dropzone").style.visibility="",document.querySelector("#dropzone").style.opacity=1,document.querySelector("#textnode").style.fontSize="48px"}),window.addEventListener("dragleave",function(t){t.preventDefault(),document.querySelector("#dropzone").style.visibility="hidden",document.querySelector("#dropzone").style.opacity=0,document.querySelector("#textnode").style.fontSize="42px"}),window.addEventListener("drop",function(e){e.preventDefault(),document.querySelector("#dropzone").style.visibility="hidden",document.querySelector("#dropzone").style.opacity=0,document.querySelector("#textnode").style.fontSize="42px";for(var n=[],i=!1,o=function t(e,i,o){if(i=i||"",e.isFile)e.file(function(t){t.relativePath=i+t.name,t.loaders=o(t),n.push(t)});else if(e.isDirectory){e.createReader().readEntries(function(n){for(var a=0;a<n.length;a++)t(n[a],i+e.name+"/",o)})}},a=e.dataTransfer.items.length,r=0;r<a;r++){if(e.dataTransfer.items[r].webkitGetAsEntry)i=!0,o(e.dataTransfer.items[r].webkitGetAsEntry(),null,t.getDataLoaders)}t.selected_files=i?n:e.dataTransfer.files,t.loadFiles()}),this.importScripts.apply(null,this.preload_main).then(function(){})},beforeRouteLeave:function(t,e,n){this.windows&&this.windows.length>0?window.confirm("Do you really want to leave? you have unsaved changes!")?n():n(!1):n()},mounted:function(){var t=this;if(setInterval(function(){t.$forceUpdate()},5e3),this.client_id=localStorage.getItem("imjoy_client_id"),this.client_id||(this.client_id="imjoy_web_"+L(),localStorage.setItem("imjoy_client_id",this.client_id)),this.$route.query.token){this.connection_token=this.$route.query.token;var e=D()({},this.$route.query);delete e.token,this.$router.replace({query:e})}else this.connection_token=localStorage.getItem("imjoy_connection_token");this.$route.query.engine?this.engine_url=this.$route.query.engine.trim():this.engine_url=localStorage.getItem("imjoy_engine_url")||"http://localhost:8080",this.plugin_api={alert:this.showAlert,register:this.register,createWindow:this.createWindow,updateWindow:this.updateWindow,showDialog:this.showDialog,showProgress:this.showProgress,showStatus:this.showStatus,run:this.runPlugin,showPluginProgress:this.showPluginProgress,showPluginStatus:this.showPluginStatus,showFileDialog:this.showFileDialog,showSnackbar:this.showSnackbar,setConfig:this.setPluginConfig,getConfig:this.getPluginConfig,getAttachment:this.getAttachment,$forceUpdate:this.$forceUpdate},this.resetPlugins(),this.pluing_context={},this.plugin_loaded=!1,this.loading=!0,this.config_db=new PouchDB("imjoy_config",{revs_limit:2,auto_compaction:!0});var n=null;this.config_db.get("workspace_list").then(function(e){t.workspace_list=e.list,n=e.default}).catch(function(e){console.error(e),t.config_db.put({_id:"workspace_list",list:["default"],default:"default"}),t.workspace_list=["default"],n="default"}).then(function(){t.selected_workspace=t.$route.query.w||n,t.workspace_list.includes(t.selected_workspace)&&t.selected_workspace==n||(t.workspace_list.includes(t.selected_workspace)||t.workspace_list.push(t.selected_workspace),t.config_db.get("workspace_list").then(function(e){t.config_db.put({_id:e._id,_rev:e._rev,list:t.workspace_list,default:"default"})})),"default"!=t.selected_workspace&&t.$router.replace({query:{w:t.selected_workspace}}),t.db=new PouchDB(t.selected_workspace+"_workspace",{revs_limit:2,auto_compaction:!0}),t.connectEngine(t.engine_url,!0)}).then(function(){t.reloadPlugins().then(function(){S.a.get("https://raw.githubusercontent.com/oeway/ImJoy-Plugins/master/manifest.json").then(function(e){if(e&&e.data&&e.data.plugins){t.manifest=e.data,t.available_plugins=t.manifest.plugins;for(var n=t.manifest.uri_root,i=0;i<t.available_plugins.length;i++){var o=t.available_plugins[i];o.uri=o.uri||o.name+".html",o.uri.startsWith(n)||o.uri.startsWith("http")||(o.uri=n+"/"+o.uri),o._id=o._id||o.name.replace(/ /g,"_")}for(var a=function(e){var n=t.available_plugins[e],i=t.installed_plugins.filter(function(t){return n.name==t.name});i.length>0&&(n.installed=!0,n.tag=i[0].tag)},r=0;r<t.available_plugins.length;r++)a(r);if(t.$route.query.plugin){var s=t.$route.query.plugin.trim();s.match(U)?(t.init_plugin_url=s,t.init_plugin_search=null):(t.init_plugin_url=null,t.init_plugin_search=s),t.show_plugin_templates=!1,t.showAddPluginDialog=!0}}})})})},beforeDestroy:function(){for(var t in this.plugins)if(this.plugins.hasOwnProperty(t)){var e=this.plugins[t];try{"function"==typeof e.terminate&&e.terminate()}catch(t){}}this.plugins=null,this.plugin_names=null,this.disconnectEngine()},methods:{setPluginConfig:function(t,e,n){var i=this.plugins[n.id];if(!i)throw"setConfig Error: Plugin not found.";return localStorage.setItem("config_"+i.name+"_"+t,e)},getPluginConfig:function(t,e){var n=this.plugins[e.id];if(!n)throw"getConfig Error: Plugin not found.";return localStorage.getItem("config_"+n.name+"_"+t)},getAttachment:function(t,e){var n=this.plugins[e.id];if(!n.attachments)return null;for(var i=0;i<n.attachments.length;i++)if(n.attachments[i].attrs.name==t)return n.attachments[i].content},showSnackbar:function(t,e,n){n||(n=e,e=null),this.show(t,e)},showFileDialog:function(t,e){if(e||(e=t,t={}),!e||!e.id)throw"Plugin not found.";var n=this.plugins[e.id];if(n)return this.$refs.file_form.reset(),this.$refs.file_select.click(),n&&n.mode,this.$refs["file-dialog"].showDialog(t)},connectPlugin:function(t){t._disconnected&&("pyworker"!=t.mode||this.engine_connected?"pyworker"!=t.mode&&this.reloadPlugin(t.config):this.connectEngine(this.engine_url))},installPlugin:function(t,e){var n=this;return new P.a(function(i,o){var a="string"==typeof t?t:t.uri;e=e||a.split("#")[1],S.a.get(a).then(function(t){if(!t||!t.data||""==t.data)return alert("failed to get plugin code from "+a),void o("failed to get code.");var r=null,s=t.data,l=yt(s);console.log("code parsed from",l);try{r=JSON.parse(l.config[0].content),console.log("loading config from .html file",r)}catch(t){console.error(t)}if(!r)return console.error("Failed to parse the plugin code.",s),void o("Failed to parse the plugin code.");if(r.uri=a,r.code=s,r.tag=e,r._id=r.name&&r.name.replace(/ /g,"_")||L(),r.dependencies)for(var c=function(t){var e=void 0;if(r.dependencies[t].match(U))n.installPlugin(r.dependencies[t]);else{e=r.dependencies[t].split("#");var i=n.available_plugins.filter(function(t){return e[0]&&t.name==e[0].trim()});i.length<=0?alert(r.name+" plugin depends on "+r.dependencies[t]+", but it can not be found in the repository."):(console.log("installing dependency ",e),i[0].installed||n.installPlugin(i[0],e[1]))}},d=0;d<r.dependencies.length;d++)c(d);var u=function(){n.db.put(r,{force:!0}).then(function(t){for(var o in console.log("Successfully installed!"),n.available_plugins)n.available_plugins.hasOwnProperty(o)&&(n.available_plugins[o].name!=r.name||n.available_plugins[o].installed||(n.available_plugins[o].installed=!0,n.available_plugins[o].tag=e));r.installed=!0,n.installed_plugins.push(r),n.reloadPlugin(r),n.$forceUpdate(),n.show(r.name+" has been sucessfully installed."),i()}).catch(function(t){n.show("Failed to install the plugin."),console.error(t)})};n.db.get(r._id).then(function(t){return n.db.remove(t)}).then(function(t){u()}).catch(function(t){u()})}).catch(function(t){console.error(t),n.show("Failed to download, if you download from github, please use the url to the raw file",6e3)})})},removePlugin:function(t){var e=this;return new P.a(function(n,i){e.db.get(t._id).then(function(t){return e.db.remove(t)}).then(function(i){for(var o=0;o<e.installed_plugins.length;o++)e.installed_plugins[o].name==t.name&&e.installed_plugins.splice(o,1);var a=!0,r=!1,s=void 0;try{for(var l,c=C()(e.available_plugins);!(a=(l=c.next()).done);a=!0){var d=l.value;d.name==t.name&&(d.installed=!1,d.tag=null)}}catch(t){r=!0,s=t}finally{try{!a&&c.return&&c.return()}finally{if(r)throw s}}e.unloadPlugin(t,!0),e.show("The plugin has been removed."),e.$forceUpdate(),n()}).catch(function(n){e.show("Error:"+n),console.error("error occured when removing ",t,n),i(n)})})},sortedPlugins:function(){return xt.a.orderBy(this.plugins,"name")},registerExtension:function(t,e){for(var n=0;n<t.length;n++)t[n]=t[n].replace(".",""),this.registered.extensions[t[n]]?this.registered.extensions[t[n]].push(e):this.registered.extensions[t[n]]=[e]},switchWorkspace:function(t){var e={w:t};"default"==t&&(e=null),this.$router.push({name:"app",query:e}),this.$router.go()},removeWorkspace:function(t){var e=this;if(this.workspace_list.includes(t)){var n=this.workspace_list.indexOf(t);this.workspace_list.splice(n,1),this.config_db.get("workspace_list").then(function(n){e.config_db.put({_id:n._id,_rev:n._rev,list:e.workspace_list,default:"default"}).then(function(){e.show("Workspace "+t+" has been deleted.")}).catch(function(){e.show("Error occured when removing workspace "+t+".")})})}this.selected_workspace==t.name&&this.$router.replace({query:{w:"default"}})},show:function(t,e){this.snackbar_info=t,this.snackbar_duration=e||3e3,this.show_snackbar=!0},connectEngine:function(t,e){var n=this;if(!this.socket||!this.engine_connected){this.engine_status="Connecting...",e||this.show("Trying to connect to the plugin engine...");var i=kt()(t),o=setTimeout(function(){n.engine_connected||(n.engine_status="Plugin Engine is not connected.",e||n.show("Failed to connect, please make sure you have started the plugin engine.",5e3),e&&i.disconnect())},2500);e||(this.showPluginEngineInfo=!0),i.on("connect",function(e){clearTimeout(o),n.connection_token=n.connection_token&&n.connection_token.trim(),i.emit("register_client",{id:n.client_id,token:n.connection_token},function(o){o.success?(n.resumable_plugins=[],n.socket=i,n.pluing_context.socket=i,n.engine_connected=!0,n.showPluginEngineInfo=!1,n.showTokenPrompt=!1,n.engine_status="Connected.",localStorage.setItem("imjoy_connection_token",n.connection_token),localStorage.setItem("imjoy_engine_url",t),n.show("Plugin Engine is connected."),n.store.event_bus.$emit("engine_connected",e),n.reloadPythonPlugins()):(i.disconnect(),n.showPluginEngineInfo||(n.showTokenPrompt=!0),console.error("failed to connect."))})}),i.on("disconnect",function(){n.engine_connected=!1,n.show("Plugin Engine disconnected."),n.engine_status="Disconnected.",n.socket=null,n.pluing_context.socket=null,n.removePythonPlugins()}),this.socket=i}},disconnectEngine:function(){this.socket&&this.socket.disconnect()},listEngineDir:function(t,e,n){var i=this;return new P.a(function(o,a){i.socket.emit("list_dir",{path:t||".",type:e||"file",recursive:n||!1},function(e){e.success?(o(e),i.$forceUpdate()):(i.show("Failed to list dir: "+t),a())})})},importScript:function(t){return new P.a(function(e,n){var i=document.createElement("script");i.src=t,i.onload=e,i.onreadystatechange=e,i.onerror=n,document.head.appendChild(i)})},importScripts:function(){var t=arguments,e=this;return b()(w.a.mark(function n(){var i,o,a;return w.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:i=Array.prototype.slice.call(t),o=i.length,a=0;case 1:if(!(a<o)){n.next=7;break}return n.next=4,e.importScript(i[a]);case 4:a++,n.next=1;break;case 7:case"end":return n.stop()}},n,e)}))()},showDoc:function(t){var e=this.plugins[t],n=e.config,i={name:"About "+n.name,type:"imjoy/markdown",w:7,h:10,scroll:!0,data:{name:n.name,id:e.id,source:n&&n.docs[0]&&n.docs[0].content}};this.addWindow(i)},editPlugin:function(t){var e=this.plugins[t],n=e.config,i={name:n.name,type:"imjoy/plugin-editor",config:{},plugin:e,reload:this.reloadPlugin,save:this.savePlugin,remove:this.removePlugin,w:10,h:10,data:{name:n.name,id:e.id,code:n.code}};this.addWindow(i)},newPlugin:function(t){var e={name:"New Plugin",type:"imjoy/plugin-editor",config:{},reload:this.reloadPlugin,save:this.savePlugin,w:10,h:10,plugin:{},data:{name:"new plugin",id:"plugin_"+L(),code:JSON.parse(g()(t))}};this.addWindow(e)},unloadPlugin:function(t,e){var n=t.name;for(var i in this.plugins)if(this.plugins.hasOwnProperty(i)){var o=this.plugins[i];if(o.name==n)try{e&&(delete this.plugins[i],delete this.plugin_names[n]),Pt.a.remove(n),"function"==typeof o.terminate&&o.terminate()}catch(t){console.error(t)}}this.$forceUpdate()},reloadPlugin:function(t){var e=this;return new P.a(function(n,i){try{e.unloadPlugin(t,!0);var o=e.parsePluginCode(t.code,t);o._id=t._id,e.unloadPlugin(o,!0);("window"==o.mode?e.preLoadPlugin(o):e.loadPlugin(o)).then(function(i){t.name=i.name,t.type=i.type,t.plugin=i,e.$refs.workflow&&e.$refs.workflow.setupJoy(),e.$forceUpdate(),n(i)}).catch(function(n){t.name=null,t.type=null,t.plugin=null,e.$forceUpdate(),i(n)})}catch(t){return e.status_text="Error: "+t,e.show("Error: "+t),void i(t)}})},savePlugin:function(t){var e=this;return new P.a(function(n,i){console.log("saving plugin ",t);var o=t.code;try{var a=e.parsePluginCode(o,{tag:t.tag});a.code=o,a._id=a.name.replace(/ /g,"_");var r=function(){e.db.put(a,{force:!0}).then(function(t){n(a._id),e.show(a.name+" has been sucessfully saved.")}).catch(function(t){e.show("failed to save the plugin."),console.error(t),i("failed to save")})};e.db.get(a._id).then(function(t){return e.db.remove(t)}).then(function(t){r()}).catch(function(t){r()})}catch(t){e.status_text="Error: "+t,e.show("Error: "+t),i(t)}})},reloadPythonPlugins:function(){var t=!0,e=!1,n=void 0;try{for(var i,o=C()(this.installed_plugins);!(t=(i=o.next()).done);t=!0){var a=i.value;"pyworker"==a.mode&&this.reloadPlugin(a)}}catch(t){e=!0,n=t}finally{try{!t&&o.return&&o.return()}finally{if(e)throw n}}},removePythonPlugins:function(){for(var t in this.plugins)if(this.plugins.hasOwnProperty(t)){var e=this.plugins[t];if("pyworker"==e.mode)try{Pt.a.remove(e.config.type),"function"==typeof e.terminate&&e.terminate()}catch(t){}}},resetPlugins:function(){var t=this;this.plugins={},this.plugin_names={},this.registered={ops:{},windows:{},extensions:{},inputs:{},outputs:{},loaders:{}},this.registered.internal_inputs={Image:{schema:O()({type:["image/jpeg","image/png","image/gif"],size:Number})}},this.registered.loaders.Image=function(e){var n=new FileReader;n.onload=function(){t.createWindow({name:e.name,type:"imjoy/image",data:{src:n.result}})},n.readAsDataURL(e)}},reloadDB:function(){var t=this;return new P.a(function(e,n){if(t.db)try{t.db.close().finally(function(){t.db=new PouchDB(t.selected_workspace+"_workspace",{revs_limit:2,auto_compaction:!0}),e()})}catch(n){console.error("failed to reload database: ",n),t.db=new PouchDB(t.selected_workspace+"_workspace",{revs_limit:2,auto_compaction:!0}),e()}else t.db=new PouchDB(t.selected_workspace+"_workspace",{revs_limit:2,auto_compaction:!0}),e()})},reloadPlugins:function(){var t=this;return new P.a(function(e,n){if(t.plugins)for(var i in t.plugins)if(t.plugins.hasOwnProperty(i)){var o=t.plugins[i];if("function"==typeof o.terminate)try{o.terminate()}catch(t){console.error(t)}t.plugins[i]=null,t.plugin_names[o.name]=null}t.resetPlugins(),t.reloadDB().then(function(){t.db.allDocs({include_docs:!0,attachments:!0,sort:"name"}).then(function(n){t.workflow_list=[],t.installed_plugins=[];for(var i=function(e){var i=n.rows[e].doc;i.workflow?t.workflow_list.push(i):(i.installed=!0,t.installed_plugins.push(i),t.reloadPlugin(i).catch(function(e){console.error(e),t.showStatus("<"+i.name+">: "+e.toString())}))},o=0;o<n.total_rows;o++)i(o);t.plugin_loaded=!0,t.loading=!1,e(),t.$forceUpdate()}).catch(function(e){console.error(e),t.loading=!1,n()})})})},closeAll:function(){this.default_window_pos={i:0,x:0,y:0,w:5,h:5},this.status_text="";for(var t=this.windows.length;t--;)"imjoy/plugin-editor"!=this.windows[t].type&&(delete this.window_ids[this.windows[t].id],this.windows.splice(t,1))},showProgress:function(t){this.progress=t<1?100*t:t},showStatus:function(t){this.status_text=t},showPluginProgress:function(t,e){if(e&&e.id){var n=this.plugins[e.id];n&&(n.progress=t<1?100*t:t,this.$forceUpdate())}},showPluginStatus:function(t,e){if(e&&e.id){var n=this.plugins[e.id];n&&(n.status_text=t,this.$forceUpdate())}},addWindow:function(t){return t.id=t.id||t.name+L(),t.loaders=this.getDataLoaders(t.data),this.generateGridPosition(t),this.windows.push(t),this.window_ids[t.id]=t,this.store.event_bus.$emit("add_window",t),t.id},closePluginDialog:function(t){this.showPluginDialog=!1;var e=f()(this._plugin_dialog_promise,2),n=e[0],i=e[1];t?n(this.$refs.plugin_dialog_joy.joy.get_config()):i(),this._plugin_dialog_promise=null},windowSelected:function(t){console.log("activate window: ",t),this.active_windows=t},windowClosed:function(t){delete this.window_ids[t.id]},windowAdded:function(t){this.window_ids[t.id]=t},generateGridPosition:function(t){t.i=this.default_window_pos.i.toString(),t.w=t.w||this.default_window_pos.w,t.h=t.h||this.default_window_pos.h,t.x=this.default_window_pos.x,t.y=this.default_window_pos.y,this.default_window_pos.x=this.default_window_pos.x+this.default_window_pos.w,this.default_window_pos.x>=20&&(this.default_window_pos.x=0,this.default_window_pos.y=this.default_window_pos.y+this.default_window_pos.h),this.default_window_pos.i=this.default_window_pos.i+1},validatePluginConfig:function(t){if(t.name.indexOf("/")<0)return!0;throw"Plugin name should not contain '/'."},getDataLoaders:function(t){var e={};for(var n in this.registered.internal_inputs)this.registered.internal_inputs.hasOwnProperty(n)&&this.registered.internal_inputs[n].schema(t)&&(e[n]=n);for(var i in this.registered.inputs)if(this.registered.inputs.hasOwnProperty(i))try{if(this.registered.inputs[i].schema(t)){var o=this.registered.inputs[i].plugin_name,a=this.registered.inputs[i].op_name;this.plugin_names[o]&&this.registered.loaders[o+"/"+a]&&(e[a]=o+"/"+a)}}catch(t){}return e},loadFiles:function(){for(var t=0;t<this.selected_files.length;t++){var e=this.selected_files[t],n=e.name.split(".");n[n.length-1];e.loaders=e.loaders||this.getDataLoaders(e)}var i={name:"Files",type:"imjoy/files",config:{},select:0,_op:"__file_loader__",_source_op:null,_workflow_id:"files_"+L(),_transfer:!1,data:this.selected_files};this.addWindow(i)},clearWorkflow:function(){this.workflow_joy_config.data="",this.$refs.workflow.setupJoy(!0)},runWorkflow:function(t){var e=this,n=this.active_windows[this.active_windows.length-1]||{};this.status_text="",this.progress=0;var i=this.plugin2joy(n)||{};i.target=i.target||{},i.target._op="workflow",i.target._source_op=null,i.target._workflow_id=i.target._workflow_id||"workflow_"+L(),t.workflow.execute(i.target).then(function(t){var n=e.joy2plugin(t);n&&(n.name="result",n.type="imjoy/generic",e.createWindow(n)),e.progress=100}).catch(function(t){console.error(t),e.status_text=t.toString()||"Error.",e.show("Error: "+t)})},saveWorkflow:function(t){var e=this,n=prompt("Please enter a name for the workflow","default");if(null!=n){var i={};i.name=n,i._id=n+"_workflow",i.workflow=g()(t.top.data),this.db.put(i,{force:!0}).then(function(t){e.workflow_list.push(i),e.show(n+" has been sucessfully saved.")}).catch(function(t){e.show("failed to save the workflow."),console.error(t),alert("error occured: "+t.toString())})}},loadWorkflow:function(t){this.workflow_joy_config.data=JSON.parse(t.workflow),this.$refs.workflow.setupJoy()},removeWorkflow:function(t){var e=this;this.db.get(t._id).then(function(t){return e.db.remove(t)}).then(function(n){var i=e.workflow_list.indexOf(t);i>-1&&e.workflow_list.splice(i,1),e.show(name+" has been sucessfully removed.")}).catch(function(t){e.show("failed to remove the workflow."),console.error(t),alert("error occured: "+t.toString())})},runOp:function(t){var e=this;this.status_text="",this.progress=0;var n=this.active_windows[this.active_windows.length-1]||{},i=this.plugin2joy(n)||{};i.target=i.target||{},i.target._op="__op__",i.target._source_op=null,i.target._workflow_id=i.target._workflow_id||"op_"+t.name.trim().replace(/ /g,"_")+L(),t.joy.__op__.execute(i.target).then(function(t){var n=e.joy2plugin(t);n&&(console.log("result",n),n.name="result",n.type="imjoy/generic",e.createWindow(n)),e.progress=100}).catch(function(n){console.error(n),e.status_text="<"+t.name+">"+(n.toString()||"Error."),e.show("Error: "+n)})},selectFileChanged:function(t){this.selected_file=t.target.files[0],this.selected_files=t.target.files;for(var e=0;e<t.target.files.length;e++){var n=t.target.files[e];n.relativePath=n.webkitRelativePath,n.loaders=this.getDataLoaders(n)}this.loadFiles()},closePanel:function(t){},parsePluginCode:function(t,e){var n=(e=e||{}).uri,i=e.tag;if(n&&n.endsWith(".js"))e.lang=e.lang||"javascript",e.script=t,e.style=null,e.window=null,e.tag=i||null;else{var o=yt(t);(e=JSON.parse(o.config[0].content)).scripts=[];for(var a=0;a<o.script.length;a++)o.script[a].attrs.lang?(e.script=o.script[a].content,e.lang=o.script[a].attrs.lang||"javascript"):e.scripts.push(o.script[a]);e.script||(e.script=o.script[0].content,e.lang=o.script[0].attrs.lang||"javascript"),e.tag=i||e.tags&&e.tags[0];for(var r=0;r<o.script.length;r++)if(o.script[r].attrs.tag==e.tag){e.script=o.script[r].content,e.lang=o.script[r].attrs.lang||"javascript";break}e.links=o.link||null,e.windows=o.window||null,e.styles=o.style||null,e.docs=o.docs||null,e.attachments=o.attachment||null}e.type=e.type||e.name,e._id=e._id||null,e.uri=n,e.code=t,e.id=e.name.trim().replace(/ /g,"_")+"_"+L();for(var s=0;s<I.length;s++){var l=e[I[s]];if(l&&"object"===(void 0===l?"undefined":m()(l))&&!(l instanceof Array)){if(!e.tag)throw"You must use 'tags' with configurable fields.";e[I[s]]=l[e.tag],l.hasOwnProperty(e.tag)||console.log("WARNING: "+I[s]+" do not contain a tag named: "+e.tag)}}if(!W(e)){var c=W.errors(e);throw console.error("Invalid plugin config: "+e.name,c),c}return e},preLoadPlugin:function(t,e){var n=this,i={name:t.name,mode:t.mode,type:t.type,ui:t.ui,tag:t.tag,inputs:t.inputs,outputs:t.outputs,_id:t._id};return this.validatePluginConfig(i),new P.a(function(o,a){e?(i.id=e.id,i.initialized=!0):(i.id=t.name.trim().replace(/ /g,"_")+"_"+L(),i.initialized=!1);var r=xt.a.assign({},t,i),s={id:i.id,name:i.name,type:i.type,config:r,mode:t.mode,docs:t.docs,tag:t.tag,attachments:t.attachments,terminate:function(){this._disconnected=!0}};n.plugins[s.id]=s,n.plugin_names[s.name]=s,i.click2load=!1,s.api={run:function(e){var i={};i.type=t.type,i.name=t.name,i.tag=t.tag,i.data=e.data,i.config=e.config,n.createWindow(i)}},n.register(i,{id:i.id}),o(s)})},loadPlugin:function(t,e){var n=this;return this.status_text="",t=N(t),this.validatePluginConfig(t),new P.a(function(i,o){var a={};e?(a.id=e.id,a.initialized=!0):(a.id=t.name.trim().replace(/ /g,"_")+"_"+L(),a.initialized=!1),a._id=t._id,a.context=n.pluing_context,"pyworker"==t.mode&&(n.socket||console.error("plugin engine is not connected."));var r=xt.a.assign({},t,a);r.workspace=n.selected_workspace;var s=new jailed.DynamicPlugin(r,xt.a.assign({TAG:r.tag,WORKSPACE:n.selected_workspace},n.plugin_api));s.whenConnected(function(){if(!s.api)throw console.error("error occured when loading plugin."),n.show("error occured when loading plugin."),"error occured when loading plugin.";t.type&&n.register(t,{id:s.id}),t.extensions&&t.extensions.length>0&&n.registerExtension(t.extensions,s),s.api.setup().then(function(t){i(s)}).catch(function(e){console.error("error occured when loading plugin "+t.name+": ",e),n.show("error occured when loading plugin "+t.name+": "+e),o(e),s.terminate()})}),s.whenFailed(function(e){e?(n.status_text=t.name+"-> Error: "+e,n.show("Error occured when loading "+t.name+": "+e)):(n.status_text="Error occured when loading "+t.name,n.show("Error occured when loading "+t.name)),console.error("error occured when loading "+t.name+": ",e),s.terminate()}),s.docs=t.docs,s.attachments=t.attachments,n.plugins[s.id]=s,n.plugin_names[s.name]=s})},runPlugin:function(t,e,n){var i=this;return b()(w.a.mark(function o(){var a,r;return w.a.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(a=void 0,n&&n.id?a=i.plugins[n.id]:(a=i.plugins[e.id],e=null),!(r=i.plugin_names[t])){o.next=17;break}return(e=e||{}).op={type:a.type,name:a.name},e.config=e.config||{},e.data=e.data||{},e.data._op=t,e.data._source_op=a.name,e.data._workflow_id=e.data._workflow_id||null,e.data._transfer=!1,o.next=14,r.api.run(i.filter4plugin(e));case 14:return o.abrupt("return",o.sent);case 17:throw"plugin with type "+t+" not found.";case 18:case"end":return o.stop()}},o,i)}))()},plugin2joy:function(t){if(!t)return null;var e={};return t.data&&t.config?(e.data=t.config,e.target=t.data):(e.data=null,e.target=t),e.target=e.target||{},Array.isArray(e.target)&&e.target.length>0&&void 0!==t.select&&e.target[t.select]&&(e.target=e.target[t.select]),e.target._variables=t._variables||{},e.target._workflow_id=t._workflow_id||null,e.target._op=t._op||null,e.target._source_op=t._source_op||null,e.target._transfer=t._transfer||!1,u()(e.target).length>4?e:null},filter4plugin:function(t){return t&&{_variables:t._variables||null,_op:t._op,_source_op:t._source_op,_transfer:t._transfer,_workflow_id:t._workflow_id,config:t.config,data:t.data}},joy2plugin:function(t){if(!t)return null;var e={_variables:t.target&&t.target._variables||null,_op:t.target&&t.target._op,_source_op:t.target&&t.target._source_op,_transfer:t.target&&t.target._transfer,_workflow_id:t.target&&t.target._workflow_id,config:t.data,data:t.target};return t.target&&(delete t.target._op,delete t.target._workflow_id,delete t.target._variables,delete t.target._source_op,delete t.target._transfer),e},register:function(t,e){var n,i,o,a,r=this;try{var s=this.plugins[e.id];if(!s)throw"Plugin not found.";if((t=N(t)).type=t.type||t.name,t.show_panel=t.show_panel||!1,t.ui=t.ui||t.name,t.tags=["op","plugin"],t.inputs=t.inputs||null,t.outputs=t.outputs||null,"window"==t.mode?t.tags.push("window"):"pyworker"==t.mode?t.tags.push("python"):"webworker"==t.mode?t.tags.push("webworker"):"iframe"==t.mode&&t.tags.push("iframe"),!A(t)){var l=A.errors(t);throw console.error("Error occured during registering "+t.name,l),l}var c=null;if(c=t.run&&"function"==typeof t.run?t.run:s&&s.api&&s.api.run,s&&c){var d=(a=b()(w.a.mark(function t(e){var n;return w.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,c(r.joy2plugin(e));case 2:return n=t.sent,t.abrupt("return",r.plugin2joy(n));case 4:case"end":return t.stop()}},t,r)})),function(t){return a.apply(this,arguments)});t.onexecute=d}else console.log("WARNING: no run function found in the config, this op won't be able to do anything: "+t.name),t.onexecute=function(){console.log("WARNING: no run function defined.")};if(t.update&&"function"==typeof t.update){var u=(o=b()(w.a.mark(function e(n){var i;return w.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.update(r.joy2plugin(n));case 2:return i=e.sent,e.abrupt("return",r.plugin2joy(i));case 4:case"end":return e.stop()}},e,r)})),function(t){return o.apply(this,arguments)});t.onupdate=R(u,300)}else if(s&&s.api&&s.api.update){var p=(i=b()(w.a.mark(function t(e){var n;return w.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,s.api.update(r.joy2plugin(e));case 2:return n=t.sent,t.abrupt("return",r.plugin2joy(n));case 4:case"end":return t.stop()}},t,r)})),function(t){return i.apply(this,arguments)});t.onupdate=R(p,300)}var h=t;h.init=h.ui||h.name,Pt.a.add(h);var f={plugin_id:e.id,name:t.name,ui:"{id: '__op__', type: '"+t.type+"'}",onexecute:t.onexecute};if(s.ops=s.ops||{},s.ops[t.name]=f,t.inputs)try{if(!("object"==t.inputs.type&&t.inputs.properties||"array"==t.inputs.type&&t.inputs.items)){if("object"!=m()(t.inputs))throw"inputs schema must be an object.";t.inputs={properties:t.inputs,type:"object"}}var v=O.a.fromJSON(t.inputs),g=s.name,_=t.name;this.registered.inputs[g+"/"+_]={op_name:_,plugin_name:g,schema:v},this.registered.loaders[g+"/"+_]=(n=b()(w.a.mark(function t(e){var n,i,o,a,l;return w.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n={},!s.config||!s.config.ui){t.next=5;break}return t.next=4,r.showDialog(s.config);case 4:n=t.sent;case 5:return e.transfer=e.transfer||!1,e._source_op=e._op,e._op=_,e._workflow_id=e._workflow_id||"data_loader_"+_.trim().replace(/ /g,"_")+L(),i={op:{name:_},target:e,data:n},t.next=12,s.api.run(r.joy2plugin(i));case 12:(o=t.sent)&&(a=r.plugin2joy(o))&&((l={}).name="result",l.type="imjoy/generic",l.config=a.data,l.data=a.target,r.createWindow(l));case 14:case"end":return t.stop()}},t,r)})),function(t){return n.apply(this,arguments)})}catch(e){console.error("something went wrong with the input schema for "+t.name,e)}if(t.outputs)try{if("object"!=t.outputs.type||!t.outputs.properties){if("object"!=m()(t.outputs))throw"inputs schema must be an object.";t.outputs={properties:t.outputs,type:"object"}}var y=O.a.fromJSON(t.outputs);this.registered.outputs[s.name+"/"+t.name]={op_name:t.name,plugin_name:s.name,schema:y}}catch(e){console.error("something went wrong with the output schema for "+t.name,t.outputs)}return this.registered.ops[s.name+"/"+t.name]=f,this.$refs.workflow&&this.$refs.workflow.setupJoy(),this.$forceUpdate(),this.registered.windows[t.name]=s.config,!0}catch(t){throw console.error(t),t}},renderWindow:function(t){var n=this;return new P.a(function(i,o){var a=xt.a.assign({},t.plugin,t);a.workspace=n.selected_workspace;var r=new jailed.DynamicPlugin(a,xt.a.assign({TAG:t.tag,WORKSPACE:n.selected_workspace},n.plugin_api));r.whenConnected(function(){if(!r.api)return console.error("the window plugin seems not ready."),void o(e);r.api.setup().then(function(e){t.data=t.data||{},t.data._source_op=t.data&&t.data._op,t.data._op=r.name,t.data._workflow_id=t.data&&t.data._workflow_id,t.plugin=r,t.update=r.api.run,r.api.run(n.filter4plugin(t)).then(function(e){if(e)for(var o in e)t[o]=e[o];i(),n.$forceUpdate()}).catch(function(t){n.status_text=r.name+"->"+t,console.error("Error in the run function of plugin "+r.name,t),n.show("Error: "+t),o(t)})}).catch(function(e){console.error("Error occured when loading the window plugin "+t.name+": ",e),n.status_text="Error occured when loading the window plugin "+t.name+": "+e,r.terminate(),n.show("Error occured when loading the window plugin "+t.name+": "+e),o(e)})}),r.whenFailed(function(e){console.error("error occured when loading "+t.name+":",e),n.status_text="error occured when loading "+t.name+": "+e,n.show("error occured when loading "+t.name+": "+e),r.terminate(),o(e)})})},updateWindow:function(t,e){var n=this;return b()(w.a.mark(function e(){var i,o,a,r,s;return w.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=t.id){e.next=3;break}throw"You must provide the window id for updating.";case 3:if(!(o=n.window_ids[i])||!o.update){e.next=11;break}return e.next=7,o.update(t);case 7:if(a=e.sent)for(r in a)o[r]=a[r];e.next=12;break;case 11:for(s in t)o[s]=t[s];case 12:case"end":return e.stop()}},e,n)}))()},createWindow:function(t,e){var n=this;return b()(w.a.mark(function e(){var i,o,a;return w.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.config=t.config||{},t.data=t.data||null,t.click2load=t.click2load||!1,t.panel=t.panel||null,T(t)){e.next=8;break}throw i=T.errors(t),console.error("Error occured during creating window "+t.name,i),i;case 8:if(!t.type||!t.type.startsWith("imjoy")){e.next=13;break}return t.id="imjoy_"+L(),e.abrupt("return",n.addWindow(t));case 13:if(o=n.registered.windows[t.type]){e.next=17;break}throw console.error("no plugin registered for window type: ",t.type),t.type;case 17:if((a=t).mode=o.mode,a.id=o.id,"window"==a.mode){e.next=22;break}throw'Window plugin must be with mode "window"';case 22:if(a.iframe_container="plugin_window_"+a.id+L(),a.iframe_window=null,a.plugin=o,a.context=n.pluing_context,a.click2load){e.next=32;break}return n.showPluginWindow(a),e.next=30,n.renderWindow(a);case 30:e.next=34;break;case 32:a.renderWindow=n.renderWindow,n.showPluginWindow(a);case 34:return e.abrupt("return",a.id);case 35:case"end":return e.stop()}},e,n)}))()},showDialog:function(t,e){var n=this;return new P.a(function(e,i){n.plugin_dialog_config=t,n.showPluginDialog=!0,n._plugin_dialog_promise=[e,i]})},showPluginWindow:function(t){if(t.type=t.type,t.data=t.data||null,t.config=t.config||{},t.panel=t.panel||null,!T(t)){var e=T.errors(t);throw console.error("Error occured during creating window "+t.name,e),e}return this.addWindow(t)},showAlert:function(t){console.log("alert: ",t),alert(t)}}},Dt=(i("ruda"),Object(s.a)(jt,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"imjoy noselect"},[t._m(0),t._v(" "),n("md-app",[n("md-app-toolbar",{staticClass:"md-dense",attrs:{"md-elevation":"0"}},[n("div",{staticClass:"md-toolbar-section-start"},[t.menuVisible?t._e():n("md-button",{staticClass:"md-primary md-icon-button",on:{click:function(e){t.menuVisible=!0}}},[n("md-icon",[t._v("menu")])],1),t._v(" "),t.menuVisible?t._e():n("md-button",{staticClass:"md-medium-hide",attrs:{to:"/"}},[n("div",{staticClass:"site-title"},[t._v("ImJoy.io"),n("span",{staticClass:"superscript md-small-hide"},[t._v("alpha")])]),t._v(" "),n("md-tooltip",[t._v("ImJoy home")])],1),t._v(" "),t.status_text&&t.status_text.length?n("md-button",{staticClass:"status-text md-small-hide",class:t.status_text.includes("rror")?"error-message":"",on:{click:function(e){t.showAlert(t.status_text)}}},[t._v("\n          "+t._s(t.status_text.slice(0,80)+(t.status_text.length>80?"...":""))+"\n        ")]):n("span",{staticClass:"subheader-title md-small-hide",staticStyle:{flex:"1"}},[t._v("Image Processing with "),n("span",{staticClass:"subheader-emoji"},[t._v("üòÅ")])])],1),t._v(" "),n("div",{staticClass:"md-toolbar-section-end"},[n("md-snackbar",{staticClass:"md-accent",attrs:{"md-position":"center","md-active":t.show_snackbar,"md-duration":t.snackbar_duration},on:{"update:mdActive":function(e){t.show_snackbar=e}}},[n("span",[t._v(t._s(t.snackbar_info))]),t._v(" "),n("md-button",{staticClass:"md-accent",on:{click:function(e){t.show_snackbar=!1}}},[t._v("close")])],1),t._v(" "),n("md-button",{staticClass:"md-icon-button",on:{click:t.closeAll}},[n("md-icon",[t._v("cancel")]),t._v(" "),n("md-tooltip",[t._v("Close all windows")])],1),t._v(" "),n("md-button",{staticClass:"md-icon-button",attrs:{disabled:!0}},[n("md-icon",[t._v("save")]),t._v(" "),n("md-tooltip",[t._v("Save all windows")])],1),t._v(" "),n("md-button",{staticClass:"md-icon-button",attrs:{target:"_blank",href:"https://github.com/oeway/ImJoy"}},[n("md-icon",[t._v("help")])],1),t._v(" "),t.engine_connected?n("md-menu",{attrs:{"md-size":"big","md-direction":"bottom-end"}},[n("md-button",{staticClass:"md-icon-button",class:t.engine_connected?"md-primary":"md-accent",attrs:{"md-menu-trigger":""}},[n("md-icon",[t._v(t._s(t.engine_connected?"sync":"sync_disabled"))]),t._v(" "),n("md-tooltip",[t._v("Connection to the Plugin Engine")])],1),t._v(" "),n("md-menu-content",[n("md-menu-item",{attrs:{disabled:!0}},[n("span",[t._v("üöÄ"+t._s(t.engine_status))])]),t._v(" "),n("md-menu-item",{on:{click:function(e){t.disconnectEngine()}}},[n("span",[t._v("Disconnect")]),t._v(" "),n("md-icon",[t._v("clear")])],1),t._v(" "),n("md-menu-item",{on:{click:function(e){t.showPluginEngineInfo=!0}}},[n("span",[t._v("About Plugin Engine")]),t._v(" "),n("md-icon",[t._v("info")])],1)],1)],1):n("md-button",{staticClass:"md-icon-button md-accent",on:{click:function(e){t.connectEngine(t.engine_url)}}},[n("md-icon",[t._v("üöÄ")]),t._v(" "),n("md-tooltip",[t._v("Connect to the Plugin Engine")])],1)],1),t._v(" "),n("form",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],ref:"folder_form"},[n("input",{ref:"folder_select",staticClass:"md-file",attrs:{type:"file",webkitdirectory:"",mozdirectory:"",msdirectory:"",odirectory:"",directory:"",multiple:""},on:{change:t.selectFileChanged}})]),t._v(" "),n("form",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],ref:"file_form"},[n("input",{ref:"file_select",staticClass:"md-file",attrs:{type:"file",multiple:""},on:{change:t.selectFileChanged}})])]),t._v(" "),n("md-app-drawer",{attrs:{"md-active":t.menuVisible,"md-persistent":"full"},on:{"update:mdActive":function(e){t.menuVisible=e}}},[n("md-speed-dial",{staticClass:"md-top-left speed-dial",attrs:{"md-event":"hover","md-effect":"scale","md-direction":"bottom"}},[n("md-speed-dial-target",{staticClass:"md-primary"},[n("md-icon",[t._v("add")])],1),t._v(" "),n("md-speed-dial-content",[n("md-button",{staticClass:"md-icon-button md-primary",on:{click:function(e){t.$refs.file_form.reset(),t.$refs.file_select.click()}}},[n("md-icon",[t._v("insert_drive_file")]),t._v(" "),n("md-tooltip",[t._v("Open a file")])],1),t._v(" "),n("md-button",{staticClass:"md-icon-button md-primary",on:{click:function(e){t.$refs.folder_form.reset(),t.$refs.folder_select.click()}}},[n("md-icon",[t._v("folder_open")]),t._v(" "),n("md-tooltip",[t._v("Open a folder")])],1)],1)],1),t._v(" "),n("div",{staticClass:"md-toolbar-row"},[n("div",{staticClass:"md-toolbar-section-start"},[n("md-button",{staticClass:"site-button",attrs:{to:"/"}},[n("div",{staticClass:"site-title"},[t._v("ImJoy.io"),n("span",{staticClass:"superscript"},[t._v("alpha")])])])],1),t._v(" "),n("div",{staticClass:"md-toolbar-section-end"},[n("md-menu",[n("md-button",{staticClass:"md-icon-button md-primary",attrs:{"md-menu-trigger":""}},[n("md-icon",[t._v("settings")])],1),t._v(" "),n("md-menu-content",[t._l(t.workspace_list,function(e){return n("md-menu-item",{key:e,on:{click:function(n){t.switchWorkspace(e)}}},[n("span",[t._v(t._s(e))]),n("md-icon",[t._v("forward")]),t._v(" "),n("md-tooltip",[t._v("Switch to workspace: "+t._s(e)+" ")])],1)}),t._v(" "),n("md-divider"),t._v(" "),n("md-menu-item",{on:{click:function(e){t.showWorkspaceDialog=!0}}},[n("md-icon",[t._v("settings")]),t._v("Workspaces\n              ")],1),t._v(" "),n("md-menu-item",{on:{click:function(e){t.showSettingsDialog=!0}}},[n("md-icon",[t._v("settings")]),t._v("General Settings\n              ")],1)],2)],1),t._v(" "),n("md-button",{staticClass:"md-icon-button md-dense md-raised",on:{click:function(e){t.menuVisible=!t.menuVisible}}},[n("md-icon",[t._v("keyboard_arrow_left")])],1)],1)]),t._v(" "),n("br"),t._v(" "),n("md-card",[n("md-card-header",[n("div",{staticClass:"md-layout md-gutter md-alignment-center-space-between"},[n("div",{staticClass:"md-layout-item md-size-70"},[n("md-button",{class:t.workflow_expand?"":"md-primary",on:{click:function(e){t.workflow_expand=!t.workflow_expand}}},[n("span",{staticClass:"md-subheading"},[t._v("Workflow")])])],1),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:t.workflow_expand,expression:"workflow_expand"}],staticClass:"md-layout-item"},[n("md-button",{staticClass:"md-icon-button",on:{click:function(e){t.clearWorkflow()}}},[n("md-icon",[t._v("clear")]),t._v(" "),n("md-tooltip",[t._v("Clear workflow")])],1)],1)])]),t._v(" "),n("md-card-content",{directives:[{name:"show",rawName:"v-show",value:t.workflow_expand,expression:"workflow_expand"}]},[t.plugin_loaded&&!t.updating_workflow?n("joy",{ref:"workflow",attrs:{config:t.workflow_joy_config}}):t._e(),t._v(" "),t.plugin_loaded?n("md-button",{staticClass:"md-button md-primary",on:{click:function(e){t.runWorkflow(t.workflow_joy_config.joy)}}},[n("md-icon",[t._v("play_arrow")]),t._v("Run\n            "),n("md-tooltip",[t._v("run the workflow")])],1):t._e(),t._v(" "),t.plugin_loaded?n("md-button",{staticClass:"md-button md-primary",on:{click:function(e){t.saveWorkflow(t.workflow_joy_config.joy)}}},[n("md-icon",[t._v("save")]),t._v("Save\n            "),n("md-tooltip",[t._v("save the workflow")])],1):t._e(),t._v(" "),n("md-menu",{attrs:{"md-size":"big"}},[n("md-button",{staticClass:"md-button md-primary",attrs:{disabled:0==t.workflow_list.length,"md-menu-trigger":""}},[n("md-icon",[t._v("more_horiz")]),t._v(" Load\n              "),n("md-tooltip",[t._v("load a workflow")])],1),t._v(" "),n("md-menu-content",t._l(t.workflow_list,function(e){return n("md-menu-item",{key:e.name,on:{click:function(n){t.loadWorkflow(e)}}},[n("span",[t._v(t._s(e.name))]),t._v(" "),n("md-button",{staticClass:"md-icon-button md-accent",on:{click:function(n){n.stopPropagation(),t.removeWorkflow(e)}}},[n("md-icon",[t._v("clear")])],1)],1)}))],1)],1)],1),t._v(" "),t.plugin_loaded?n("div",[n("md-card",[n("md-card-header",[n("div",{staticClass:"md-layout md-gutter md-alignment-center-space-between"},[n("div",{staticClass:"md-layout-item md-size-70"},[n("md-button",{staticClass:"md-raised",class:t.installed_plugins.length>0?"":"md-primary",on:{click:function(e){t.show_plugin_templates=!0,t.showAddPluginDialog=!0}}},[n("md-icon",[t._v("add")]),t._v("Plugins\n                ")],1)],1),t._v(" "),n("div",{staticClass:"md-layout-item"},[n("md-button",{staticClass:"md-icon-button",on:{click:function(e){t.reloadPlugins()}}},[n("md-icon",[t._v("autorenew")]),t._v(" "),n("md-tooltip",[t._v("Reload plugins")])],1)],1)])]),t._v(" "),n("md-card-content",[t._l(t.sortedPlugins(),function(e){return n("div",{key:e.name},[n("md-divider"),t._v(" "),n("md-menu",{attrs:{"md-size":"medium"}},[n("md-button",{staticClass:"md-icon-button",class:e.running?"md-accent":"",attrs:{"md-menu-trigger":""}},[e.initializing?n("md-progress-spinner",{staticClass:"md-accent",attrs:{"md-diameter":20,"md-mode":"indeterminate"}}):e.config.icon?n("md-icon",[t._v(t._s(e.config.icon))]):n("md-icon",[t._v("extension")]),t._v(" "),n("md-tooltip",[t._v("show more options for the plugin")])],1),t._v(" "),n("md-menu-content",[n("md-menu-item",{on:{click:function(n){t.showDoc(e.id)}}},[n("md-icon",[t._v("description")]),t._v("Docs\n                  ")],1),t._v(" "),n("md-menu-item",{on:{click:function(n){t.editPlugin(e.id)}}},[n("md-icon",[t._v("edit")]),t._v("Edit\n                  ")],1),t._v(" "),n("md-menu-item",{on:{click:function(n){t.reloadPlugin(e.config)}}},[n("md-icon",[t._v("autorenew")]),t._v("Reload\n                  ")],1),t._v(" "),n("md-menu-item",{on:{click:function(n){t.unloadPlugin(e)}}},[n("md-icon",[t._v("clear")]),t._v("Terminate\n                  ")],1),t._v(" "),n("md-menu-item",{on:{click:function(n){t._plugin2_remove=e,t.showRemoveConfirmation=!0}}},[n("md-icon",[t._v("delete_forever")]),t._v("Remove\n                  ")],1)],1)],1),t._v(" "),n("md-button",{staticClass:"joy-run-button",class:e.running?"md-accent":e._disconnected?"disconnected-plugin":"md-primary",attrs:{disabled:e._disconnected&&"pyworker"!=e.mode},on:{click:function(n){e._disconnected?t.connectPlugin(e):t.runOp(e.ops[e.name])}}},[t._v("\n                "+t._s(e.name)+"\n              ")]),t._v(" "),n("md-button",{staticClass:"md-icon-button",on:{click:function(n){e.panel_expanded=!e.panel_expanded,t.$forceUpdate()}}},[e.panel_expanded?n("md-icon",[t._v("expand_less")]):n("md-icon",[t._v("expand_more")])],1),t._v(" "),e.running&&e.progress?n("md-progress-bar",{attrs:{"md-mode":"determinate","md-value":e.progress}}):t._e(),t._v(" "),e.running&&e.status_text?n("p",[t._v(t._s(e.status_text))]):t._e(),t._v(" "),t._l(e.ops,function(i,o){return n("div",{key:i.plugin_id+i.name},[n("md-button",{directives:[{name:"show",rawName:"v-show",value:e.panel_expanded&&i.name!=e.name,expression:"plugin.panel_expanded && op.name != plugin.name"}],staticClass:"md-icon-button",attrs:{disabled:!0}},[n("md-icon",[t._v("remove")])],1),t._v(" "),n("md-button",{directives:[{name:"show",rawName:"v-show",value:e.panel_expanded&&i.name!=e.name,expression:"plugin.panel_expanded && op.name != plugin.name"}],staticClass:"joy-run-button md-primary",class:e.running?"md-accent":"md-primary",attrs:{disabled:e._disconnected},on:{click:function(e){t.runOp(i)}}},[t._v("\n                    "+t._s(i.name)+"\n                ")]),t._v(" "),n("md-button",{directives:[{name:"show",rawName:"v-show",value:e.panel_expanded&&i.name!=e.name,expression:"plugin.panel_expanded &&  op.name != plugin.name"}],staticClass:"md-icon-button",on:{click:function(e){i.panel_expanded=!i.panel_expanded,t.$forceUpdate()}}},[i.panel_expanded?n("md-icon",[t._v("expand_less")]):n("md-icon",[t._v("expand_more")])],1),t._v(" "),n("joy",{attrs:{config:i,show:e.panel_expanded&&(!!e.panel_expanded&&i.name==e.name||i.panel_expanded)||!1}}),t._v(" "),n("md-divider")],1)})],2)}),t._v(" "),n("md-divider"),t._v(" "),t.installed_plugins.length<=0?n("p",[t._v("¬†No plugin installed.")]):t._e()],2)],1)],1):t._e()],1),t._v(" "),n("md-app-content",{staticClass:"whiteboard-content"},[n("md-progress-bar",{attrs:{"md-mode":"determinate","md-value":t.progress}}),t._v(" "),n("whiteboard",{attrs:{windows:t.windows,loaders:t.registered&&t.registered.loaders},on:{add:t.windowAdded,close:t.windowClosed,select:t.windowSelected}})],1)],1),t._v(" "),n("md-dialog-confirm",{attrs:{"md-active":t.showRemoveConfirmation,"md-title":"Removing Plugin","md-content":"Do you really want to <strong>delete</strong> this plugin","md-confirm-text":"Yes","md-cancel-text":"Cancel"},on:{"update:mdActive":function(e){t.showRemoveConfirmation=e},"md-cancel":function(e){t.showRemoveConfirmation=!1},"md-confirm":function(e){t.removePlugin(t._plugin2_remove),t._plugin2_remove=null,t.showRemoveConfirmation=!1}}}),t._v(" "),n("file-dialog",{ref:"file-dialog",attrs:{"list-files":t.listEngineDir}}),t._v(" "),n("md-dialog",{attrs:{"md-active":t.showPluginDialog,"md-click-outside-to-close":!1},on:{"update:mdActive":function(e){t.showPluginDialog=e}}},[n("md-dialog-content",[t.plugin_dialog_config?n("div",[n("joy",{ref:"plugin_dialog_joy",attrs:{config:t.plugin_dialog_config,showHeader:!1,controlButtons:!1}})],1):t._e()]),t._v(" "),n("md-dialog-actions",[n("md-button",{staticClass:"md-primary",on:{click:function(e){t.closePluginDialog(!0)}}},[t._v("OK")]),t._v(" "),n("md-button",{staticClass:"md-primary",on:{click:function(e){t.closePluginDialog(!1)}}},[t._v("Cancel")])],1)],1),t._v(" "),n("md-dialog",{attrs:{"md-active":t.showWorkspaceDialog,"md-click-outside-to-close":!1},on:{"update:mdActive":function(e){t.showWorkspaceDialog=e}}},[n("md-dialog-title",[t._v("Workspace Management")]),t._v(" "),n("md-dialog-content",[n("md-toolbar",{staticClass:"md-dense",attrs:{"md-elevation":"0"}},[n("div",{staticClass:"md-toolbar-section-start"},[n("md-field",[n("label",{attrs:{for:"workspace_name"}},[t._v("Workspace Name")]),t._v(" "),n("md-input",{attrs:{type:"text",placeholder:"Create a new workspace",name:"workspace_name"},model:{value:t.new_workspace_name,callback:function(e){t.new_workspace_name=e},expression:"new_workspace_name"}})],1)],1),t._v(" "),n("div",{staticClass:"md-toolbar-section-end"},[n("md-button",{staticClass:"md-primary",on:{click:function(e){t.showWorkspaceDialog=!1,t.switchWorkspace(t.new_workspace_name)}}},[n("md-icon",[t._v("add")]),t._v("New")],1)],1)]),t._v(" "),n("md-list",{staticClass:"md-double-line md-dense"},t._l(t.workspace_list,function(e){return n("md-list-item",{key:e},[n("span",[t._v(t._s(e))]),t._v(" "),n("md-menu",[n("md-button",{staticClass:"md-icon-button md-list-action",attrs:{"md-menu-trigger":""}},[n("md-icon",{staticClass:"md-primary"},[t._v("more_horiz")])],1),t._v(" "),n("md-menu-content",[n("md-menu-item",{on:{click:function(n){t.showWorkspaceDialog=!1,t.switchWorkspace(e)}}},[n("md-icon",[t._v("forward")]),t._v(" Switch\n                ")],1),t._v(" "),n("md-menu-item",{staticClass:"md-accent",on:{click:function(n){t.removeWorkspace(e)}}},[n("md-icon",[t._v("delete")]),t._v(" Delete\n                ")],1)],1)],1)],1)}))],1),t._v(" "),n("md-dialog-actions",[n("md-button",{staticClass:"md-primary",on:{click:function(e){t.showWorkspaceDialog=!1}}},[t._v("OK")])],1)],1),t._v(" "),n("md-dialog-prompt",{attrs:{"md-active":t.showTokenPrompt,"md-title":"What is the connection token?","md-input-maxlength":"36","md-click-outside-to-close":!1,"md-input-placeholder":"Please go to the plugin engine terminal to get the token.","md-confirm-text":"Connect"},on:{"update:mdActive":function(e){t.showTokenPrompt=e},"md-confirm":function(e){t.connectEngine(t.engine_url)}},model:{value:t.connection_token,callback:function(e){t.connection_token=e},expression:"connection_token"}}),t._v(" "),n("md-dialog",{attrs:{"md-active":t.showPluginEngineInfo,"md-click-outside-to-close":!1},on:{"update:mdActive":function(e){t.showPluginEngineInfo=e}}},[n("md-dialog-title",[t._v("Using the Python Plugin Engine")]),t._v(" "),n("md-dialog-content",[n("p",[t._v("\n          Python plugins are supported by ImJoy with the Python Plugin Engine. "),n("br"),n("br"),t._v("\n          If you have it already, run "),n("strong",[t._v("python -m imjoy")]),t._v(" in a `Terminal`(mac/linux) or `Anaconda Prompt`(windows).\n        ")]),t._v(" "),n("md-field",[n("label",{attrs:{for:"engine_url"}},[t._v("Plugin Engine URL")]),t._v(" "),n("md-input",{attrs:{type:"text",name:"engine_url"},model:{value:t.engine_url,callback:function(e){t.engine_url=e},expression:"engine_url"}})],1),t._v(" "),n("md-field",[n("label",{attrs:{for:"connection_token"}},[t._v("Connection Token")]),t._v(" "),n("md-input",{attrs:{type:"text",name:"connection_token"},model:{value:t.connection_token,callback:function(e){t.connection_token=e},expression:"connection_token"}})],1),t._v(" "),n("p",[t._v("¬†"+t._s(t.engine_status))]),t._v(" "),t.engine_connected?t._e():n("md-button",{staticClass:"md-primary",on:{click:function(e){t.connectEngine(t.engine_url)}}},[t._v("Connect")]),t._v(" "),n("p",[t._v("\n          If you don't have it, you need to do the following:"),n("br"),t._v("\n          ¬†¬†* Install "),n("a",{attrs:{href:"https://conda.io/miniconda.html",target:"_blank"}},[t._v("Miniconda")]),t._v(" or "),n("a",{attrs:{href:"https://www.anaconda.com/download/",target:"_blank"}},[t._v("Anaconda")]),t._v(" (Python3.6+ version is recommanded) "),n("br"),t._v("\n          ¬†¬†* Open a `Terminal`(mac/linux) or `Anaconda Prompt`(windows), then run the following command:"),n("br"),t._v("\n          ¬†¬†¬†¬†¬†"),n("strong",[t._v("conda -V && pip install -U git+https://github.com/oeway/ImJoy-Python#egg=imjoy")]),n("br"),t._v("\n          ¬†¬†* Run "),n("strong",[t._v("python -m imjoy")]),t._v(" in the terminal to start the engine."),n("br"),n("br"),t._v("\n          Once the plugin engine is ready, click the `CONNECT` button below."),n("br"),t._v("\n          If you encountered any error related to git or pip, try to run "),n("strong",[t._v("conda install -y git pip")]),t._v(" before the above command."),n("br"),t._v("\n          If you still failed to set it up, please consult "),n("a",{attrs:{href:"https://github.com/oeway/ImJoy-Python",target:"_blank"}},[t._v("here")]),n("br"),t._v(" "),n("br")]),n("p",[n("strong",[t._v("Update: we are experimenting an easier way to install and use the plugin engine, please try it out "),n("a",{attrs:{href:"https://github.com/oeway/ImJoy-Python/releases",target:"_blank"}},[t._v("here")]),t._v(".")])]),t._v(" "),n("p")],1),t._v(" "),n("md-dialog-actions",[n("md-button",{staticClass:"md-primary",on:{click:function(e){t.showPluginEngineInfo=!1}}},[t._v("Cancel")]),t._v(" "),n("md-button",{staticClass:"md-primary",on:{click:function(e){t.showPluginEngineInfo=!1,t.connectEngine(t.engine_url)}}},[t._v("OK")])],1)],1),t._v(" "),n("md-dialog",{attrs:{"md-active":t.showSettingsDialog,"md-click-outside-to-close":!1},on:{"update:mdActive":function(e){t.showSettingsDialog=e}}},[n("md-dialog-title",[t._v("Settings")]),t._v(" "),n("md-dialog-content",[n("md-divider"),t._v(" "),n("md-card",[n("md-card-header",[n("div",{staticClass:"md-title"},[t._v("General Settings")])]),t._v(" "),n("md-card-content",[n("md-field",[n("label",{attrs:{for:"engine_url"}},[t._v("Plugin Engine URL")]),t._v(" "),n("md-input",{attrs:{type:"text",name:"engine_url"},model:{value:t.engine_url,callback:function(e){t.engine_url=e},expression:"engine_url"}})],1),t._v(" "),n("md-field",[n("label",{attrs:{for:"connection_token"}},[t._v("Connection Token")]),t._v(" "),n("md-input",{attrs:{type:"text",name:"connection_token"},model:{value:t.connection_token,callback:function(e){t.connection_token=e},expression:"connection_token"}})],1),t._v(" "),n("md-button",{staticClass:"md-primary",on:{click:function(e){t.connectEngine(t.engine_url),t.showSettingsDialog=!1}}},[t._v("Connect Plugin Engine")]),t._v(" "),n("md-button",{staticClass:"md-primary",on:{click:function(e){t.disconnectEngine()}}},[t._v("Disconnect Plugin Engine")]),t._v(" "),n("p",[t._v(t._s(t.engine_status))])],1)],1),t._v(" "),n("md-divider"),t._v(" "),n("md-card",[n("md-card-header",[n("div",{staticClass:"md-title"},[t._v("Installed Plugins")])]),t._v(" "),n("md-card-content",[n("plugin-list",{attrs:{display:"list",database:t.db,"install-plugin":t.installPlugin,"remove-plugin":t.removePlugin,plugins:t.installed_plugins,workspace:t.selected_workspace},on:{message:t.show}})],1)],1)],1),t._v(" "),n("md-dialog-actions",[n("md-button",{staticClass:"md-primary",on:{click:function(e){t.showSettingsDialog=!1}}},[t._v("OK")])],1)],1),t._v(" "),n("md-dialog",{attrs:{"md-active":t.showAddPluginDialog,"md-click-outside-to-close":!0},on:{"update:mdActive":function(e){t.showAddPluginDialog=e}}},[n("md-dialog-title",[t._v("Plugins Management")]),t._v(" "),n("md-dialog-content",[t.show_plugin_templates?n("md-card",[n("md-card-header",[n("div",{staticClass:"md-title"},[t._v("Create a New Plugin")])]),t._v(" "),n("md-card-content",t._l(t.plugin_templates,function(e,i){return n("md-button",{key:i,staticClass:"md-primary md-raised centered-button",on:{click:function(n){t.newPlugin(e),t.showAddPluginDialog=!1}}},[n("md-icon",[t._v("add")]),t._v(t._s(i)+"\n          ")],1)}))],1):t._e(),t._v(" "),n("md-divider"),t._v(" "),n("md-card",[n("md-card-header",[n("div",{staticClass:"md-title"},[t._v("Or, install from the Plugin Store")])]),t._v(" "),n("md-card-content",[n("plugin-list",{attrs:{"show-url":"",database:t.db,"install-plugin":t.installPlugin,"remove-plugin":t.removePlugin,"init-url":t.init_plugin_url,"init-search":t.init_plugin_search,display:"list",plugins:t.available_plugins,workspace:t.selected_workspace},on:{message:t.show}})],1)],1),t._v(" "),n("md-divider"),t._v(" "),n("md-card",[n("md-card-header",[n("div",{staticClass:"md-title"},[t._v("Installed Plugins")])]),t._v(" "),n("md-card-content",[n("plugin-list",{attrs:{display:"list",database:t.db,"install-plugin":t.installPlugin,"remove-plugin":t.removePlugin,plugins:t.installed_plugins,workspace:t.selected_workspace},on:{message:t.show}})],1)],1)],1),t._v(" "),n("md-dialog-actions",[n("md-button",{staticClass:"md-primary",on:{click:function(e){t.showAddPluginDialog=!1}}},[t._v("OK")])],1)],1)],1)},[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticStyle:{visibility:"hidden",opacity:"0"},attrs:{id:"dropzone"}},[e("div",{attrs:{id:"textnode"}},[this._v("Drop files to add data.")])])}],!1,null,"140c06f1",null));Dt.options.__file="Imjoy.vue";var Et=Dt.exports,St={name:"about",props:{faq:{type:Boolean,default:!0},footer:{type:Boolean,default:!0}},data:function(){return{}},created:function(){this.router=this.$root.$data.router,this.store=this.$root.$data.store,this.api=this.$root.$data.store.api},mounted:function(){},methods:{}},$t=(i("jPlm"),Object(s.a)(St,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"about"},[n("md-subheader",[t._v("About ImJoy.io")]),t._v(" "),n("md-card",[n("md-card-header"),t._v(" "),n("md-card-content",{staticClass:"centered-fixed"},[n("md-icon",{staticClass:"md-size-5x md-small-hide",attrs:{"md-src":"static/img/anna-palm-icon-circle.svg"}}),t._v(" "),n("h2",[t._v("Acknowledgements")]),t._v(" "),n("p",[t._v("ImJoy.io project is mainly supported by\n      ")]),t._v(" "),n("p",[n("a",{attrs:{href:"https://www.pasteur.fr",target:"_blank"}},[n("img",{attrs:{id:"ip-img",src:"static/img/Institut_Pasteur_logo.svg",alt:"Institut Pasteur"}})])]),t._v(" "),n("br")],1)],1),t._v(" "),t.faq?n("faq"):t._e(),t._v(" "),n("br"),t._v(" "),n("br"),t._v(" "),t.footer?n("md-divider"):t._e(),t._v(" "),t.footer?n("main-footer"):t._e()],1)},[],!1,null,"71188376",null));$t.options.__file="About.vue";var Ot=$t.exports;var It=i("EFqf"),Wt=i.n(It),At={name:"faq",data:function(){return{source:"\n\n## How to import script in the plugin?\nThere are two different mode for the plugin to run a certain code: in webworker mode, you can use the original importScripts function, notice that it's synchronized version;\nin iframe mode, we provided a importScripts function, but it's an async version, means you can use promise or await on that.\n\nIn order to unify the code, the recommended way is, if you want to load multiple scripts in order, and use Promise.resolve to normalize the result into a promise.\n\nFor example the following code will behave the same in webworker mode or iframe mode:\n\n```\nPromise.resolve(importScripts(\"https://xxxx/script1.js\", \"https://xxxx/script2.js\")).then(()=>{\n  console.log('scripts loaded.')\n})\n```\n\n\n\n"}},created:function(){this.router=this.$root.$data.router,this.store=this.$root.$data.store,this.api=this.$root.$data.store.api},computed:{compiledMarkdown:function(){return Wt()(this.source,{sanitize:!0})}},mounted:function(){},methods:{}},Tt=(i("hZjZ"),Object(s.a)(At,function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"faq"},[e("md-subheader",[this._v("FREQUENTLY ASKED QUESTIONS")]),this._v(" "),e("md-card",[e("md-card-header"),this._v(" "),e("md-card-content",[e("div",{domProps:{innerHTML:this._s(this.compiledMarkdown)}})])],1)],1)},[],!1,null,"1d5b776c",null));Tt.options.__file="FAQ.vue";var Ut=Tt.exports;o.default.use(a.a);var Rt=new a.a({base:window.location.pathName,routes:[{path:"/",name:"Home",component:c},{path:"/home",redirect:"/"},{path:"/app",name:"app",component:Et},{path:"/:)",redirect:{name:"joy"}},{path:"/%F0%9F%98%82",name:"joy",component:Et},{path:"/imjoy",name:"Imjoy",component:Et},{path:"/about",name:"About",component:Ot},{path:"/faq",name:"FAQ",component:Ut},{path:"*",redirect:"/"}]}),Lt=i("Lgyv"),Nt=i.n(Lt),Mt=(i("4+hh"),i("giDI"),i("GDE4")),Ft=i.n(Mt),zt={name:"navbar",data:function(){return{snackbar_info:"",snackbar_duration:1e3,showSnackbar:!1,screenWidth:window.innerWidth}},created:function(){this.router=this.$root.$data.router,this.store=this.$root.$data.store,this.api=this.$root.$data.store.api},mounted:function(){var t=this;this.screenWidth=window.innerWidth;this.store.event_bus.$on("resize",function(e){t.screenWidth=e.width})},methods:{shareOnTwitter:function(){window.open("http://twitter.com/share?url="+encodeURIComponent("https://imjoy.io")+"&text="+encodeURIComponent(" #ImJoy "),"","left=0,top=0,width=550,height=450,personalbar=0,toolbar=0,scrollbars=0,resizable=0")}}},Bt=(i("vbFt"),Object(s.a)(zt,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"md-toolbar-row"},[n("div",{staticClass:"md-toolbar-row",attrs:{flex:""}},[n("md-button",{attrs:{to:"/"}},[n("div",{staticClass:"site-title"},[t._v("ImJoy.io"),n("span",{staticClass:"superscript"},[t._v("alpha")])])]),t._v(" "),n("span",{directives:[{name:"show",rawName:"v-show",value:"/"!=t.$route.path,expression:"$route.path!='/'"}],staticClass:"md-layout-item md-medium-hide subheader-title"},[t._v("Image processing with joy.")]),t._v(" "),n("div",{staticClass:"md-toolbar-section-end"},[t.screenWidth<600?n("md-menu",{attrs:{"md-size":"medium"}},[n("md-button",{staticClass:"md-primary md-icon-button",attrs:{"md-menu-trigger":""}},[n("md-icon",[t._v("menu")])],1),t._v(" "),n("md-menu-content",[n("md-menu-item",{directives:[{name:"show",rawName:"v-show",value:"/"!=t.$route.path,expression:"$route.path != '/'"}],staticClass:"md-primary md-button menu-button",attrs:{to:"/"}},[t._v("Home")]),t._v(" "),n("md-menu-item",{directives:[{name:"show",rawName:"v-show",value:"/app"!=t.$route.path,expression:"$route.path != '/app'"}],staticClass:"md-primary md-button menu-button",attrs:{to:"/app"}},[t._v("Start ImJoy")]),t._v(" "),n("md-menu-item",{staticClass:"md-primary md-button menu-button",attrs:{href:"https://github.com/oeway/ImJoy"}},[t._v("Source")]),t._v(" "),n("md-menu-item",{staticClass:"md-primary md-button menu-button",attrs:{href:"https://github.com/oeway/ImJoy/blob/master/README.md"}},[t._v("Docs")]),t._v(" "),n("md-menu-item",{directives:[{name:"show",rawName:"v-show",value:"/about"!=t.$route.path,expression:"$route.path != '/about'"}],staticClass:"md-primary md-button menu-button",attrs:{to:"/about"}},[t._v("About")])],1)],1):t._e(),t._v(" "),t.screenWidth>=600?n("md-button",{directives:[{name:"show",rawName:"v-show",value:"/"!=t.$route.path,expression:"$route.path != '/'"}],staticClass:"md-accent",attrs:{to:"/"}},[n("md-icon",[t._v("home")]),t._v(" Home\n            "),n("md-tooltip",[t._v("Home Page")])],1):t._e(),t._v("\n          ¬†\n          "),t.screenWidth>=600?n("md-button",{directives:[{name:"show",rawName:"v-show",value:"/app"!=t.$route.path,expression:"$route.path != '/app'"}],staticClass:"md-accent",attrs:{to:"/app"}},[n("md-icon",[t._v("mood")]),t._v(" ImJoy\n            "),n("md-tooltip",[t._v("Start ImJoy App")])],1):t._e(),t._v("\n          ¬†\n          "),t.screenWidth>=600?n("md-button",{staticClass:"md-accent",attrs:{href:"https://github.com/oeway/ImJoy",target:"_blank"}},[n("md-icon",{staticClass:"md-size-1x svg-icon",attrs:{"md-src":"static/img/github.svg"}}),t._v("source\n            "),n("md-tooltip",[t._v("Source code on Github")])],1):t._e(),t._v("\n          ¬†\n          "),t.screenWidth>=600?n("md-button",{staticClass:"md-accent",attrs:{href:"https://github.com/oeway/ImJoy/blob/master/README.md"}},[n("md-icon",[t._v("library_books")]),t._v("docs\n            "),n("md-tooltip",[t._v("Documentation")])],1):t._e(),t._v(" "),t._v("\n          ¬†\n          "),t.screenWidth>=600?n("md-button",{directives:[{name:"show",rawName:"v-show",value:"/about"!=t.$route.path,expression:"$route.path != '/about'"}],staticClass:"md-accent",attrs:{to:"/about"}},[n("md-icon",[t._v("info")]),t._v(" About\n            "),n("md-tooltip",[t._v("About ImJoy.io")])],1):t._e()],1)],1),t._v(" "),n("md-snackbar",{staticClass:"md-accent",attrs:{"md-position":"center","md-active":t.showSnackbar,"md-duration":t.snackbar_duration},on:{"update:mdActive":function(e){t.showSnackbar=e}}},[n("span",[t._v(t._s(t.snackbar_info))]),t._v(" "),n("md-button",{staticClass:"md-accent",on:{click:function(e){t.showSnackbar=!1}}},[t._v("close")])],1)],1)},[],!1,null,"70926688",null));Bt.options.__file="Navbar.vue";var Jt=Bt.exports,Vt={name:"main-footer",data:function(){return{mode:"about",showDialog:!1,showQuestion:!1}},created:function(){this.router=this.$root.$data.router,this.store=this.$root.$data.store,this.api=this.$root.$data.store.api},mounted:function(){},methods:{}},qt=(i("9RcE"),Object(s.a)(Vt,function(){var t=this,e=t.$createElement,n=t._self._c||e;return"/app"!=t.$route.path&&"/app"!=t.$route.path?n("div",{staticClass:"footer"},[n("div",{staticClass:"md-layout md-alignment-center-center"},[n("md-button",{staticClass:"md-accent footer-button",attrs:{target:"_blank",href:"https://github.com/oeway/ImJoy/issues"}},[t._v("Create an issue on Github")])],1),t._v(" "),n("div",{staticClass:"md-layout md-alignment-center-center"},[n("md-button",{staticClass:"footer-button",attrs:{href:"https://creativecommons.org/licenses/by/4.0/",target:"_blank"}},[n("md-tooltip",[t._v("Except where otherwise noted, content on this site is licensed under a Creative Commons Attribution 4.0 International license.")]),t._v(" "),n("img",{attrs:{id:"cc-by-img",src:"static/img/by.svg",alt:"CC BY 4.0"}}),t._v(" Site content licensed under CC BY 4.0\n    ")],1),t._v(" "),n("md-button",{staticClass:"footer-button",on:{click:function(e){t.mode="about",t.showDialog=!0}}},[t._v("About ImJoy.io")])],1),t._v(" "),n("div",{staticClass:"md-layout md-alignment-center-center"},[n("md-button",{staticClass:"footer-button",attrs:{href:"https://github.com/oeway",target:"_blank"}},[t._v("Made by Wei OUYANG with "),n("span",{staticClass:"red"},[t._v("‚ù§")])]),t._v(" "),n("md-button",{staticClass:"footer-button",attrs:{target:"_blank",href:"https://sites.google.com/site/imagingandmodeling/"}},[t._v("Powered by Imaging and Modeling Unit")]),t._v(" "),t._m(0)],1)]):t._e()},[function(){var t=this.$createElement,e=this._self._c||t;return e("a",{attrs:{href:"https://www.pasteur.fr",target:"_blank"}},[e("img",{attrs:{id:"ip-img",src:"static/img/Institut_Pasteur_logo.svg",alt:"Institut Pasteur"}})])}],!1,null,"a50c386a",null));qt.options.__file="Footer.vue";var Ht=qt.exports,Kt={name:"whiteboard",props:{windows:{type:Array,default:function(){return null}},loaders:{type:Object,default:function(){return null}}},data:function(){return{row_height:30,column_width:30,active_windows:[],show_overlay:!1}},created:function(){this.router=this.$root.$data.router,this.store=this.$root.$data.store,this.api=this.$root.$data.store.api,this.store.event_bus.$on("add_window",this.onWindowAdd),this.marked=Wt.a},mounted:function(){},beforeDestroy:function(){this.store.event_bus.$off("add_window",this.onWindowAdd)},methods:{onWindowAdd:function(t){this.selectWindow(t,{})},close:function(t){console.log("close",t);var e=this.active_windows.indexOf(this.windows[t]);e>=0&&(this.active_windows[e].selected=!1,this.active_windows.splice(e,1),this.$emit("select",this.active_windows,null)),this.$emit("close",this.windows[t]),this.windows.splice(t,1)},isTypedArray:function(t){return!!t&&void 0!==t.byteLength},fullScreen:function(t){var e=parseInt(this.$refs.whiteboard.clientHeight/this.row_height)-10,n=parseInt(this.$refs.whiteboard.clientWidth/this.column_width)-1;t._h=t.h,t._w=t.w,t.h=e,t.w=n,setTimeout(function(){t.resize&&t.resize()},1e3)},normalSize:function(t){t.h=t._h||5,t.w=t._w||5,t._w=null,t._h=null,setTimeout(function(){t.resize&&t.resize()},1e3)},duplicate:function(t){var e=D()({},t);e.iframe_container&&(e.iframe_container="plugin_window_"+e.id+L()),e.i=e.i+"_",e.click2load||(e.click2load=!0),t.renderWindow&&(e.renderWindow=t.renderWindow),e.id=e.name+L(),this.windows.push(e),this.$emit("add",e)},unselectWindows:function(){if(this.active_windows&&this.active_windows.length>0){for(var t=0;t<this.active_windows.length;t++)this.active_windows[t].selected=!1;this.active_windows=[],this.$emit("select",[],null),this.$forceUpdate()}},selectWindow:function(t,e){if(t.selected=!0,this.active_windows.length<=0||this.active_windows[this.active_windows.length-1]!==t){if(!e.shiftKey)for(var n=0;n<this.active_windows.length;n++)this.active_windows[n].selected=!1;e.shiftKey&&this.active_windows.length>0?this.active_windows.push(t):this.active_windows=[t],this.$emit("select",this.active_windows,t)}else if(!e.shiftKey&&this.active_windows.length>1){for(var i=0;i<this.active_windows.length;i++)this.active_windows[i]!==t&&(this.active_windows[i].selected=!1);this.active_windows=[t]}this.$forceUpdate()},focusWindow:function(t){this.show_overlay=!0,this.selectWindow(t,{})},stopDragging:function(){var t=this;setTimeout(function(){t.show_overlay=!1,t.$forceUpdate()},300)},printObject:function(t,e){console.log(t,e)},dataSummary:function(t){return"array"==typeof t.data?t.type+", "+m()(t.data)+", length: "+t.data.length:t.data.buffer&&"[object ArrayBuffer]"===Object.prototype.toString.call(t.data.buffer)?t.type+", typedarray, length: "+t.data.length:"object"==m()(t.data)?t.type+", "+m()(t.data)+", length: "+u()(t.data).length:""+t.type}}},Xt=(i("ZnPw"),Object(s.a)(Kt,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{ref:"whiteboard",staticClass:"whiteboard noselect",on:{click:function(e){t.unselectWindows()}}},[t.show_overlay?n("div",{staticClass:"overlay",on:{click:function(e){t.show_overlay=!1}}}):t._e(),t._v(" "),n("grid-layout",{attrs:{layout:t.windows,"col-num":20,"is-mirrored":!1,"auto-size":!0,"row-height":t.row_height,"col-width":t.column_width,"is-draggable":!0,"is-resizable":!0,"vertical-compact":!0,margin:[3,3],"use-css-transforms":!0}},t._l(t.windows,function(e,i){return n("grid-item",{key:e.iframe_container,attrs:{"drag-ignore-from":".code_editor",x:e.x,y:e.y,w:e.w,h:e.h,i:e.i},on:{resize:function(n){t.focusWindow(e)},move:function(n){t.focusWindow(e)},resized:function(n){t.show_overlay=!1,e.resize&&e.resize()},moved:function(n){t.show_overlay=!1,e.move&&e.move()}}},[n("md-card",[n("md-card-expand",[n("md-card-actions",{class:e.selected?"window-selected":"window-header",attrs:{"md-alignment":"space-between"}},[e.panel?n("md-card-expand-trigger",[n("md-button",{staticClass:"md-icon-button"},[n("md-icon",[t._v("keyboard_arrow_down")])],1)],1):t._e(),t._v(" "),e.panel?t._e():n("div"),t._v(" "),n("div",{staticClass:"window-title noselect",on:{dblclick:function(n){e._h&&e._w?t.normalSize(e):t.fullScreen(e)},click:function(n){n.stopPropagation(),t.selectWindow(e,n)}}},[t._v(t._s(e.name+"(#"+e.i+")"))]),t._v(" "),n("div",[n("md-menu",{attrs:{"md-size":"big","md-direction":"bottom-end"}},[n("md-button",{staticClass:"md-icon-button",attrs:{"md-menu-trigger":""}},[n("md-icon",[t._v("more_vert")])],1),t._v(" "),n("md-menu-content",[e._h&&e._w?n("md-menu-item",{on:{click:function(n){n.stopPropagation(),t.normalSize(e)}}},[n("span",[t._v("Normal view")]),t._v(" "),n("md-icon",[t._v("fullscreen")])],1):n("md-menu-item",{on:{click:function(n){n.stopPropagation(),t.fullScreen(e)}}},[n("span",[t._v("Fullscreen")]),t._v(" "),n("md-icon",[t._v("fullscreen")])],1),t._v(" "),n("md-menu-item",{on:{click:function(n){n.stopPropagation(),t.duplicate(e)}}},[n("span",[t._v("Duplicate")]),t._v(" "),n("md-icon",[t._v("filter")])],1),t._v(" "),"main"!=e.type?n("md-menu-item",{on:{click:function(e){t.close(i)}}},[n("span",[t._v("Close")]),t._v(" "),n("md-icon",[t._v("close")])],1):t._e(),t._v(" "),n("md-menu-item",{on:{click:function(n){t.printObject(e.type,e.data)}}},[n("span",[t._v("Console.log")]),t._v(" "),n("md-icon",[t._v("bug_report")])],1),t._v(" "),t._l(e.loaders,function(i,o){return e.loaders?n("md-menu-item",{key:o,on:{click:function(n){t.loaders&&t.loaders[i](e.data)}}},[n("span",[t._v(t._s(o))]),t._v(" "),n("md-icon",[t._v("play_arrow")])],1):t._e()})],2)],1)],1)],1),t._v(" "),e.panel?n("md-card-expand-content",[n("md-card-content",[n("joy",{attrs:{config:e.panel}})],1)],1):t._e()],1),t._v(" "),n("md-card-content",{class:e.scroll?"plugin-iframe-container allow-scroll":"plugin-iframe-container"},["empty"==e.type?n("md-empty-state",{attrs:{"md-icon":"hourglass_empty","md-label":"IMJOY.IO","md-description":""}}):t._e(),t._v(" "),"imjoy/files"==e.type?n("div",{staticClass:"generic-plugin-window"},[n("md-list",t._l(e.data,function(i,o){return n("md-list-item",{key:i.name+i.relativePath},[n("md-radio",{attrs:{value:o},model:{value:e.select,callback:function(n){t.$set(e,"select",n)},expression:"w.select"}}),t._v(" "),n("span",{staticClass:"md-list-item-text",staticStyle:{cursor:"pointer"},on:{click:function(e){t.loaders&&i.loaders&&Object.keys(i.loaders).length>0&&t.loaders[i.loaders[Object.keys(i.loaders)[0]]](i)}}},[t._v(t._s(i.name))]),t._v(" "),i.loaders&&Object.keys(i.loaders).length>0?n("md-menu",{attrs:{"md-size":"big","md-direction":"bottom-end"}},[n("md-button",{staticClass:"md-icon-button",attrs:{"md-menu-trigger":""}},[n("md-icon",[t._v("more_horiz")])],1),t._v(" "),n("md-menu-content",t._l(i.loaders,function(e,o){return n("md-menu-item",{key:o,on:{click:function(n){t.loaders&&t.loaders[e](i)}}},[n("span",[t._v(t._s(o))]),t._v(" "),n("md-icon",[t._v("play_arrow")])],1)}))],1):t._e()],1)}))],1):"imjoy/image"==e.type?n("div",[e.data.src?n("img",{staticStyle:{width:"100%"},attrs:{src:e.data.src}}):n("p",[t._v(" No image available for display.")])]):"imjoy/images"==e.type?n("div",t._l(e.data.images,function(i){return e.data.images?n("img",{staticStyle:{width:"100%"},attrs:{src:i}}):n("p",[t._v(" No image available for display.")])})):"imjoy/panel"==e.type?n("div",[n("joy",{attrs:{config:e.config}})],1):"imjoy/markdown"==e.type?n("div",[e.data.source&&""!=e.data.source.trim()?n("div",{staticStyle:{"padding-left":"10px","padding-right":"5px",overflow:"auto"},domProps:{innerHTML:t._s(t.marked(e.data.source,{sanitize:!0}))}}):n("h3",[t._v(" Oops, this plugin has no documentation!")])]):"imjoy/generic"==e.type?n("div",{staticClass:"generic-plugin-window"},[n("md-list",[t.loaders&&e.loaders&&Object.keys(e.loaders).length>0?n("md-list-item",{staticClass:"md-primary",on:{click:function(n){t.loaders[e.loaders[Object.keys(e.loaders)[0]]](e.data)}}},[n("span",{staticClass:"md-list-item-text md-primary"},[t._v('Open with "'+t._s(Object.keys(e.loaders)[0])+'"')]),t._v(" "),n("md-tooltip",[t._v('click to open with "'+t._s(Object.keys(e.loaders)[0])+'".')])],1):n("md-list-item",[n("span",{staticClass:"md-list-item-text"},[t._v(t._s(t.dataSummary(e)))])]),t._v(" "),t._l(e.data,function(i,o){return!t.isTypedArray(e.data)&&(!o.startsWith||!o.startsWith("_"))&&e.data&&!e.data.length||(e.data.length||e.data.byteLength)&&(e.data.length||e.data.byteLength)>0&&o<=20?n("md-list-item",{key:o},[n("md-icon",[t._v("insert_drive_file")]),t._v(" "),n("span",{staticClass:"md-list-item-text",on:{click:function(e){t.printObject(o,i)}}},[t._v(t._s(o))])],1):t._e()}),t._v(" "),e.data&&(e.data.length||e.data.byteLength)&&(e.data.length||e.data.byteLength)>20?n("md-list-item",{on:{click:function(n){t.printObject(e.data)}}},[n("md-icon",[t._v("insert_drive_file")]),t._v(" "),n("span",{staticClass:"md-list-item-text"},[t._v("...")]),t._v(" "),n("md-tooltip",[t._v("click to print the data in your console.")])],1):t._e()],2)],1):"imjoy/plugin-editor"==e.type?n("plugin-editor",{attrs:{pluginId:e.data.id,window:e,editorId:"editor_"+e.data.id},model:{value:e.data.code,callback:function(n){t.$set(e.data,"code",n)},expression:"w.data.code"}}):n("div",{staticClass:"plugin-iframe"},[e.click2load?n("md-button",{staticClass:"iframe-load-button",on:{click:function(t){e.click2load=!1,e.renderWindow(e)}}},[t._v("Click to load the window")]):t._e(),t._v(" "),n("div",{staticClass:"plugin-iframe",attrs:{id:e.iframe_container}})],1)],1)],1)],1)})),t._v(" "),n("div",{staticClass:"md-layout md-gutter md-alignment-center-center"},[t.windows&&0!=t.windows.length?t._e():n("md-empty-state",{attrs:{"md-icon":"static/img/anna-palm-icon-circle-animation.svg","md-label":"IMJOY.IO","md-description":""}})],1)],1)},[],!1,null,"f2659ed0",null));Xt.options.__file="Whiteboard.vue";var Yt=Xt.exports,Gt=this,Zt={name:"joy",props:{show:{type:Boolean,default:function(){return!0}},config:{type:Object,default:function(){return{}}}},data:function(){return{joy:null,isRunning:!1}},created:function(){this.router=this.$root.$data.router,this.store=this.$root.$data.store,this.api=this.$root.$data.store.api},mounted:function(){setTimeout(this.setupJoy,500)},watch:{config:function(t,e){Gt.setupJoy&&Gt.setupJoy()}},methods:{editSource:function(){this.$emit("edit",this.config)},setupJoy:function(t){!t&&this.joy&&(this.config.data=this.joy.top.data),this.$refs.editor.innerHTML="";var e={container:this.$refs.editor,init:this.config.ui||"",data:this.config.data||Pt.a.loadFromURL(),modules:this.config.modules||["instructions","math"],onexecute:this.config.onexecute,onupdate:this.config.onupdate};try{this.joy=new Pt.a(e)}catch(t){e.data="",this.joy=new Pt.a(e)}this.config.joy=this.joy},runJoy:function(){this.$emit("run",this.joy)},stopJoy:function(){this.$emit("stop")}}},Qt=(i("v0UZ"),Object(s.a)(Zt,function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"joy"},[e("div",{directives:[{name:"show",rawName:"v-show",value:this.show,expression:"show"}],staticClass:"joy-container"},[e("div",{ref:"editor",staticClass:"joy-editor"})])])},[],!1,null,null,null));Qt.options.__file="Joy.vue";var te=Qt.exports,ee={name:"plugin-list",props:{configUrl:{type:String,default:null},database:{type:PouchDB,default:null},workspace:{type:String,default:"default"},title:{type:String,default:null},display:{type:String,default:function(){return"list"}},showUrl:{type:Boolean,default:!1},initUrl:{type:String,default:null},initSearch:{type:String,default:null},center:{type:Boolean,default:!0},plugins:{type:Array,default:function(){return null}},installPlugin:{type:Function,default:null},removePlugin:{type:Function,default:null}},data:function(){return{search:"",editorCode:"",plugin_url:"",editorPlugin:null,showEditor:!1,containerWidth:500,uri_root:null,plugin_dir:null,manifest:null,available_plugins:[],searched_plugins:[],showRemoveConfirmation:!1,_plugin2_remove:null,showDocsDialog:!1,docs:null,db:null}},created:function(){this.router=this.$root.$data.router,this.store=this.$root.$data.store,this.api=this.$root.$data.store.api,this.marked=Wt.a},mounted:function(){var t=this;this.plugin_url=this.initUrl||"",this.search=this.initSearch||"",this.containerWidth=this.$refs.container.offsetWidth,this.store.event_bus.$on("resize",this.updateSize),this.db=this.database||new PouchDB(this.workspace+"_workspace",{revs_limit:2,auto_compaction:!0}),this.plugins?(this.available_plugins=this.plugins,this.searched_plugins=this.plugins,this.search&&this.searchPlugin()):this.configUrl&&S.a.get(this.configUrl).then(function(e){if(e&&e.data&&e.data.plugins){t.manifest=e.data,t.available_plugins=t.manifest.plugins,t.searched_plugins=t.manifest.plugins;for(var n=t.manifest.uri_root,i=0;i<t.available_plugins.length;i++){var o=t.available_plugins[i];o.uri=o.uri||o.name+".html",o.uri.startsWith(n)||o.uri.startsWith("http")||(o.uri=n+"/"+o.uri),o._id=o._id||o.name.replace(/ /g,"_")}t.plugin_dir=t.manifest.uri_root,t.plugin_dir?(t.uri_root=location.protocol+"//"+location.host,t.plugin_dir.startsWith("http")||(t.plugin_dir=t.uri_root+t.plugin_dir,console.log(t.plugin_dir))):(t.uri_root="",t.plugin_dir=""),t.search&&t.searchPlugin()}})},beforeDestroy:function(){this.store.event_bus.$off("resize",this.updateSize)},methods:{toLower:function(t){return t.toString().toLowerCase()},searchByName:function(t,e){var n=this;return e?t.filter(function(t){return n.toLower(t.name+" "+t.description).includes(n.toLower(e))}):t},searchPlugin:function(){this.searched_plugins=this.searchByName(this.available_plugins,this.search)},updateSize:function(){this.containerWidth=this.$refs.container.offsetWidth},showDocs:function(t){var e=this;if(t.installed)this.db.get(t._id).then(function(t){var n=yt(t.code);e.docs=n.docs&&n.docs[0]&&n.docs[0].content,e.showDocsDialog=!0,e.$forceUpdate()}).catch(function(e){console.log("error occured when editing ",t.name,e)});else{var n=t.uri;S.a.get(n).then(function(t){if(t&&t.data&&""!=t.data){var i=yt(t.data);e.docs=i.docs&&i.docs[0]&&i.docs[0].content,e.showDocsDialog=!0,e.$forceUpdate()}else alert("failed to get plugin code from "+n)})}},showCode:function(t){var e=this;if(t.installed)this.db.get(t._id).then(function(n){e.editorCode=n.code,e.editorPlugin=t,e.showEditor=!0,e.$forceUpdate()}).catch(function(e){console.log("error occured when editing ",t.name,e)});else{var n=t.uri;S.a.get(n).then(function(i){i&&i.data&&""!=i.data?(e.editorCode=i.data,e.editorPlugin=t,e.showEditor=!0,e.$forceUpdate()):alert("failed to get plugin code from "+n)})}},updateAll:function(){var t=this,e=[],n=!0,i=!1,o=void 0;try{for(var a,r=C()(this.available_plugins);!(n=(a=r.next()).done);n=!0){var s=a.value;s.installed&&e.push(this.install(s,s.tag))}}catch(t){i=!0,o=t}finally{try{!n&&r.return&&r.return()}finally{if(i)throw o}}P.a.all(e).then(function(){console.log("All plugins updated successfully."),t.$emit("message","All plugins updated successfully.")}).catch(function(e){console.error("Plugins updated with error.",e),t.$emit("message","Plugins updated with error.")})},install:function(t,e){var n=this;if(this.installPlugin){var i=this.installPlugin(t,e);i&&i.then(function(){n.$forceUpdate()})}},remove:function(t){var e=this;if(this.removePlugin){var n=this.removePlugin(t);n&&n.then(function(){e.$forceUpdate()})}}}},ne=(i("ow1S"),Object(s.a)(ee,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{ref:"container",staticClass:"plugin-list"},[t.title?n("md-subheader",[t._v(t._s(t.title)+"\n  ")]):t._e(),t._v(" "),n("md-toolbar",{attrs:{"md-elevation":"0"}},[n("md-field",{directives:[{name:"show",rawName:"v-show",value:!t.plugin_url,expression:"!plugin_url"}],staticClass:"md-toolbar-section-start",attrs:{"md-clearable":""}},[n("md-icon",[t._v("search")]),t._v(" "),n("md-input",{attrs:{placeholder:"Search by name..."},on:{input:t.searchPlugin},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1),t._v(" "),n("md-field",{directives:[{name:"show",rawName:"v-show",value:t.showUrl&&!t.search,expression:"showUrl && !search"}],staticClass:"md-toolbar-section-start",attrs:{"md-clearable":""}},[n("md-icon",[t._v("cloud_download")]),t._v(" "),n("md-input",{attrs:{placeholder:"Install plugin from url",type:"text",name:"plugin_url"},model:{value:t.plugin_url,callback:function(e){t.plugin_url=e},expression:"plugin_url"}})],1),t._v(" "),n("md-button",{directives:[{name:"show",rawName:"v-show",value:t.installPlugin&&t.showUrl&&t.plugin_url&&""!=t.plugin_url,expression:"installPlugin && showUrl && plugin_url&&plugin_url!=''"}],staticClass:"md-button md-primary",on:{click:function(e){t.install(t.plugin_url)}}},[n("md-icon",[t._v("cloud_download")]),t._v("Install\n    ")],1),t._v(" "),n("md-button",{directives:[{name:"show",rawName:"v-show",value:!t.search&&!t.plugin_url&&t.installPlugin,expression:"!search&&!plugin_url && installPlugin"}],staticClass:"md-button md-primary",on:{click:function(e){t.updateAll()}}},[n("md-icon",[t._v("update")]),n("span",{staticClass:"md-small-hide"},[t._v("Update All")])],1)],1),t._v(" "),"list"==t.display?n("md-list",{staticClass:"md-triple-line md-dense"},t._l(t.searched_plugins,function(e,i){return n("div",{key:i},[n("md-list-item",[n("md-avatar",[e.icon?n("md-icon",[t._v(t._s(e.icon))]):n("md-icon",[t._v("extension")])],1),t._v(" "),n("div",{staticClass:"md-list-item-text"},[n("span",[t._v(t._s(e.name))]),t._v(" "),n("p",[t._v(t._s(e.description))]),t._v(" "),n("p",t._l(e.tags,function(e){return n("span",{key:e},[t._v(t._s(e)+"; ")])}))]),t._v(" "),n("p",[t.installPlugin&&!e.installed&&e.tags&&e.tags.length>0?n("md-menu",[n("md-button",{staticClass:"md-icon-button md-list-action md-primary",attrs:{"md-menu-trigger":""}},[n("md-icon",[t._v("cloud_download")]),t._v(" "),n("md-tooltip",[t._v("Install "+t._s(e.name))])],1),t._v(" "),n("md-menu-content",t._l(e.tags,function(i){return n("md-menu-item",{key:i,on:{click:function(n){t.install(e,i)}}},[n("md-icon",[t._v("cloud_download")]),t._v(t._s(i)+"\n            ")],1)}))],1):!e.installed&&t.installPlugin?n("md-button",{staticClass:"md-icon-button md-list-action md-primary",on:{click:function(n){t.install(e)}}},[n("md-icon",[t._v("cloud_download")]),t._v(" "),n("md-tooltip",[t._v("Install "+t._s(e.name))])],1):t._e(),t._v(" "),e.installed&&t.installPlugin?n("md-button",{staticClass:"md-icon-button md-list-action md-primary",on:{click:function(n){t.install(e)}}},[n("md-icon",[t._v("update")]),t._v(" "),n("md-tooltip",[t._v("Update "+t._s(e.name))])],1):t._e(),t._v(" "),t.removePlugin&&e.installed?n("md-button",{staticClass:"md-icon-button md-list-action md-accent",on:{click:function(n){t._plugin2_remove=e,t.showRemoveConfirmation=!0}}},[n("md-icon",[t._v("delete_forever")]),t._v(" "),n("md-tooltip",[t._v("Delete "+t._s(e.name))])],1):t._e()],1),t._v(" "),n("md-menu",[n("md-button",{staticClass:"md-icon-button md-list-action",attrs:{"md-menu-trigger":""}},[n("md-icon",{staticClass:"md-primary"},[t._v("more_horiz")])],1),t._v(" "),n("md-menu-content",[n("md-menu-item",{on:{click:function(n){t.showDocs(e)}}},[n("md-icon",[t._v("description")]),t._v("Documentation\n            ")],1),t._v(" "),!e.installed&&t.installPlugin?n("md-menu-item",{on:{click:function(n){t.install(e)}}},[n("md-icon",[t._v("cloud_download")]),t._v("Install\n            ")],1):t._e(),t._v(" "),e.installed&&t.installPlugin?n("md-menu-item",{on:{click:function(n){t.install(e)}}},[n("md-icon",[t._v("update")]),t._v("Update\n            ")],1):t._e(),t._v(" "),e.installed&&t.removePlugin?n("md-menu-item",{on:{click:function(n){t._plugin2_remove=e,t.showRemoveConfirmation=!0}}},[n("md-icon",[t._v("delete_forever")]),t._v("Delete\n            ")],1):t._e(),t._v(" "),n("md-menu-item",{on:{click:function(n){t.showCode(e)}}},[n("md-icon",[t._v("code")]),t._v("Code\n            ")],1)],1)],1)],1),t._v(" "),n("md-divider",{staticClass:"md-inset"})],1)})):t._e(),t._v(" "),"card"==t.display?n("div",[t._l(t.searched_plugins,function(e,i){return t.containerWidth<=500?n("md-card",{key:i},[n("md-card-header",[t._v("\n        "+t._s(e.createdAt)+"\n        "),n("h2",[t._v(t._s(e.name))]),t._v(" "),n("p",[t._v(t._s(e.description))]),t._v(" "),t._l(e.tags,function(e){return n("md-chip",{key:e},[t._v(t._s(e))])})],2),t._v(" "),n("md-card-content",[t.installPlugin&&!e.installed&&e.tags&&e.tags.length>0?n("md-menu",[n("md-button",{staticClass:"md-button md-primary",attrs:{"md-menu-trigger":""}},[n("md-icon",[t._v("cloud_download")]),t._v("Install\n          ")],1),t._v(" "),n("md-menu-content",t._l(e.tags,function(i){return n("md-menu-item",{key:i,on:{click:function(n){t.install(e,i)}}},[n("md-icon",[t._v("cloud_download")]),t._v(t._s(i)+"\n            ")],1)}))],1):t.installPlugin&&!e.installed?n("md-button",{staticClass:"md-button md-primary",on:{click:function(n){t.install(e)}}},[n("md-icon",[t._v("cloud_download")]),t._v("Install")],1):t._e(),t._v(" "),t.installPlugin&&e.installed?n("md-button",{staticClass:"md-button md-primary",on:{click:function(n){t.install(e,e.tag)}}},[n("md-icon",[t._v("update")]),t._v("Update")],1):t._e(),t._v(" "),t.removePlugin&&e.installed?n("md-button",{staticClass:"md-accent",on:{click:function(n){t._plugin2_remove=e,t.showRemoveConfirmation=!0}}},[n("md-icon",[t._v("delete_forever")]),t._v("Delete")],1):t._e(),t._v(" "),n("md-button",{staticClass:"md-button md-primary",on:{click:function(n){t.showDocs(e)}}},[n("md-icon",[t._v("note")]),t._v("Docs\n        ")],1),t._v(" "),n("md-button",{staticClass:"md-button md-primary",on:{click:function(n){t.showCode(e)}}},[n("md-icon",[t._v("code")]),t._v("Code\n        ")],1)],1)],1):t._e()}),t._v(" "),t.containerWidth>500?n("grid",{staticClass:"grid-container",attrs:{center:t.center,draggable:!1,sortable:!0,items:t.searched_plugins,"cell-width":380,"cell-height":280,"grid-width":t.containerWidth},scopedSlots:t._u([{key:"cell",fn:function(e){return[n("md-card",[n("md-card-header",[n("h2",[t._v(t._s(e.item.name)+" "),e.item.icon?n("md-icon",[t._v(t._s(e.item.icon))]):n("md-icon",[t._v("extension")])],1),t._v(" "),n("p",[t._v(t._s(e.item.description))]),t._v(" "),t._l(e.item.tags,function(e){return n("md-chip",{key:e},[t._v(t._s(e))])})],2),t._v(" "),n("md-card-content",[t.installPlugin&&!e.item.installed&&e.item.tags&&e.item.tags.length>0?n("md-menu",[n("md-button",{staticClass:"md-button md-primary",attrs:{"md-menu-trigger":""}},[n("md-icon",[t._v("cloud_download")]),t._v("Install\n           ")],1),t._v(" "),n("md-menu-content",t._l(e.item.tags,function(i){return n("md-menu-item",{key:i,on:{click:function(n){t.install(e.item,i)}}},[n("md-icon",[t._v("cloud_download")]),t._v(t._s(i)+"\n             ")],1)}))],1):!e.item.installed&&t.installPlugin?n("md-button",{staticClass:"md-button md-primary",on:{click:function(n){t.install(e.item)}}},[n("md-icon",[t._v("cloud_download")]),t._v("Install")],1):t._e(),t._v(" "),e.item.installed&&t.installPlugin?n("md-button",{staticClass:"md-button md-primary",on:{click:function(n){t.install(e.item,e.item.tag)}}},[n("md-icon",[t._v("update")]),t._v("Update")],1):t._e(),t._v(" "),e.item.installed&&t.removePlugin?n("md-button",{staticClass:"md-accent",on:{click:function(n){t._plugin2_remove=e.item,t.showRemoveConfirmation=!0}}},[n("md-icon",[t._v("delete_forever")]),t._v("Delete")],1):t._e(),t._v(" "),n("md-button",{staticClass:"md-button md-primary",on:{click:function(n){t.showDocs(e.item)}}},[n("md-icon",[t._v("note")]),t._v("Docs\n         ")],1),t._v(" "),n("md-button",{staticClass:"md-button md-primary",on:{click:function(n){t.showCode(e.item)}}},[n("md-icon",[t._v("code")]),t._v("Code")],1)],1)],1)]}}])}):t._e()],2):t._e(),t._v(" "),n("br"),t._v(" "),n("md-dialog-confirm",{attrs:{"md-active":t.showRemoveConfirmation,"md-title":"Removing Plugin","md-content":"Do you really want to <strong>delete</strong> this plugin","md-confirm-text":"Yes","md-cancel-text":"Cancel"},on:{"update:mdActive":function(e){t.showRemoveConfirmation=e},"md-cancel":function(e){t.showRemoveConfirmation=!1},"md-confirm":function(e){t.remove(t._plugin2_remove),t.showRemoveConfirmation=!1}}}),t._v(" "),n("md-dialog",{staticClass:"editor-dialog",attrs:{"md-active":t.showEditor},on:{"update:mdActive":function(e){t.showEditor=e}}},[n("md-dialog-content",[n("plugin-editor",{staticClass:"code-editor",attrs:{title:"Plugin Editor"},model:{value:t.editorCode,callback:function(e){t.editorCode=e},expression:"editorCode"}})],1),t._v(" "),n("md-dialog-actions",[n("md-button",{staticClass:"md-primary",on:{click:function(e){t.showEditor=!1}}},[t._v("OK")])],1)],1),t._v(" "),n("md-dialog",{attrs:{"md-active":t.showDocsDialog},on:{"update:mdActive":function(e){t.showDocsDialog=e}}},[n("md-dialog-content",[t.docs&&""!=t.docs.trim()?n("div",{staticStyle:{"padding-left":"10px","padding-right":"5px"},domProps:{innerHTML:t._s(t.marked(t.docs,{sanitize:!0}))}}):n("h3",[t._v(" Oops, this plugin has no documentation!")])]),t._v(" "),n("md-dialog-actions",[n("md-button",{staticClass:"md-primary",on:{click:function(e){t.showDocsDialog=!1}}},[t._v("OK")])],1)],1)],1)},[],!1,null,"126211db",null));ne.options.__file="PluginList.vue";var ie=ne.exports,oe=i("lDdF"),ae=i("6KKO");window.MonacoEnvironment={getWorkerUrl:function(t,e){var n=location.protocol+"//"+location.hostname+(location.port?":"+location.port:"");return"data:text/javascript;charset=utf-8,"+encodeURIComponent("\n      self.MonacoEnvironment = {\n        baseUrl: '"+n+"/static'\n      };\n      try {\n        importScripts('"+n+"/static/vs/base/worker/workerMain.js');\n      } catch (e) {\n        console.error(e)\n      } finally {\n\n      }\n      ")}};var re={name:"joy",props:["value","title","pluginId","window"],data:function(){return{codeValue:""}},created:function(){this.router=this.$root.$data.router,this.store=this.$root.$data.store,this.api=this.$root.$data.store.api},watch:{},mounted:function(){var t=this;this.codeValue=this.value,this.editor=this.$refs.monaco_editor.getMonaco(),this.window&&(this.window.resize=function(){t.editor.layout()}),setTimeout(function(){t.editor.layout()},1e3),this.editor.addCommand(window.monaco.KeyMod.CtrlCmd|window.monaco.KeyCode.KEY_S,function(){t.save()}),this.editor.addCommand(window.monaco.KeyMod.CtrlCmd|window.monaco.KeyCode.KEY_R,function(){t.reload()})},methods:{save:function(){var t=this;this.$emit("input",this.codeValue);t.window.save({pluginId:t.pluginId,code:t.codeValue}).then(function(e){t.window.data._id=e,t.window.plugin.config._id=e,t.$forceUpdate()}),this.reload()},remove:function(){var t=this;this.$emit("input",this.codeValue),this.window.data._id=null,this.window.remove(this.window.plugin).then(function(){t.window.plugin={}})},reload:function(){var t=this;return new P.a(function(e,n){t.codeValue&&(t.$emit("input",t.codeValue),t.window.reload({pluginId:t.pluginId,tag:t.window.plugin.tag,type:t.window.plugin.type,name:t.window.plugin.name,code:t.codeValue,plugin:t.window.plugin}).then(function(n){t.window.plugin=n,t.window.name=n.name,e()}).catch(function(t){n(t)}))})},saveAs:function(){this.$emit("input",this.codeValue);var t=this.window&&this.window.plugin&&this.window.plugin.name?this.window.plugin.name+"_"+L()+".imjoy.html":"plugin_"+L()+".imjoy.html",e=new Blob([this.codeValue],{type:"text/plain;charset=utf-8"});Object(oe.saveAs)(e,t)}}},se=(i("LAj/"),Object(s.a)(re,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"plugin-editor"},[n("md-toolbar",{staticClass:"md-dense editor-toolbar md-layout md-gutter",attrs:{"md-elevation":"1"}},[t.window?n("md-button",{staticClass:"md-icon-button",on:{click:function(e){t.reload()}}},[n("md-icon",[t._v("autorenew")]),t._v(" "),n("md-tooltip",[t._v("Update this plugin")])],1):t._e(),t._v(" "),t.window?n("md-button",{staticClass:"md-icon-button",on:{click:function(e){t.save()}}},[n("md-icon",[t._v("save")]),t._v(" "),n("md-tooltip",[t._v("Save this plugin")])],1):t._e(),t._v(" "),n("md-button",{staticClass:"md-icon-button",on:{click:function(e){t.saveAs()}}},[n("md-icon",[t._v("cloud_download")]),t._v(" "),n("md-tooltip",[t._v("Export this plugin")])],1),t._v(" "),t.window&&t.window.plugin&&t.window.plugin.config&&t.window.plugin.config._id?n("md-button",{staticClass:"md-icon-button",on:{click:function(e){t.remove()}}},[n("md-icon",[t._v("delete")]),t._v(" "),n("md-tooltip",[t._v("Remove this plugin")])],1):t._e(),t._v(" "),t.window&&t.window.plugin&&t.window.plugin.tags&&t.window.plugin.tags.length>1?n("md-field",{staticClass:"md-layout-item md-size-20"},[n("md-select",{attrs:{id:"tag",name:"tag"},on:{"md-selected":function(e){t.reload()}},model:{value:t.window.plugin.tag,callback:function(e){t.$set(t.window.plugin,"tag",e)},expression:"window.plugin.tag"}},t._l(t.window.plugin.tags,function(e){return n("md-option",{key:e,attrs:{value:e}},[t._v(t._s(e))])}))],1):t._e()],1),t._v(" "),n("monaco-editor",{ref:"monaco_editor",staticClass:"editor code_editor",attrs:{language:"html"},model:{value:t.codeValue,callback:function(e){t.codeValue=e},expression:"codeValue"}})],1)},[],!1,null,"28fb27c5",null));se.options.__file="PluginEditor.vue";var le=se.exports,ce={name:"file-item",props:{model:Object,selected:[String,Array],root:{type:String,default:"."}},data:function(){return{open:!0}},mounted:function(){},computed:{isFolder:function(){return this.model.children&&this.model.children.length}},methods:{load:function(t){this.$emit("load",t||{target:this.model,path:this.root})},select:function(t,e){e?this.$emit("select_append",t||{target:this.model,path:this.root+"/"+this.model.name}):this.$emit("select",t||{target:this.model,path:this.root+"/"+this.model.name})},toggle:function(){this.isFolder&&(this.open=!this.open)}}},de=(i("urWN"),Object(s.a)(ce,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("li",[n("div",[t.isFolder?n("span",{on:{click:t.toggle}},[t._v("["+t._s(t.open?"-":"+")+"]")]):t._e(),t._v(" "),n("span",{on:{click:function(e){t.select({target:t.model,path:t.root},e.shiftKey)},dblclick:function(e){t.load()}}},["file"==t.model.type?n("md-icon",[t._v("insert_drive_file")]):n("md-icon",[t._v("folder_open")]),t._v(" "),n("span",{staticClass:"noselect",class:{bold:t.isFolder,selected:t.root==t.selected||t.selected&&Array.isArray(t.selected)&&t.selected.indexOf(t.root)>=0}},[t._v(t._s(t.model.name))])],1),t._v(" "),t.isFolder?n("md-icon-button",{on:{click:function(e){t.load()}}},[n("md-icon",[t._v("arrow_upward")])],1):t._e()],1),t._v(" "),t.open&&t.isFolder?n("ul",t._l(t.model.children.slice(0,300),function(e,i){return n("file-item",{key:i,staticClass:"item",attrs:{root:t.root+"/"+e.name,model:e,selected:t.selected},on:{load:function(e){t.load(e)},select:function(e){t.select(e)},select_append:function(e){t.select(e,!0)}}})})):t._e()])},[],!1,null,"02bc9e22",null));de.options.__file="FileItem.vue";var ue=de.exports,pe={name:"file-dialog",props:{listFiles:Function,mode:String},data:function(){return{root:null,options:{},show_:!1,file_tree_selection:null,file_tree:null,resolve:null,reject:null}},mounted:function(){},computed:{},methods:{fileTreeSelected:function(t){"file"==this.options.type&&"dir"==t.target.type||(this.file_tree_selection=t.path,this.$forceUpdate())},fileTreeSelectedAppend:function(t){Array.isArray(this.file_tree_selection)||(this.file_tree_selection=this.file_tree_selection?[this.file_tree_selection]:[]),this.file_tree_selection.push(t.path),this.$forceUpdate()},loadFile:function(t){var e=this;"file"!=t.target.type?(t.path==this.root&&(t.path=t.path+"/../"),this.listFiles(t.path,this.options.type,this.options.recursive).then(function(t){e.root=t.path,e.file_tree=t,e.$forceUpdate()})):(this.show_=!1,"single"==this.options.mode&&"object"===m()(this.file_tree_selection)?this.resolve(this.file_tree_selection[0]):"multiple"==this.options.mode&&"string"==typeof this.file_tree_selection?this.resolve([this.file_tree_selection]):this.resolve(this.file_tree_selection))},showDialog:function(t){var e=this;return this.show_=!0,this.options=t,this.options.title=this.options.title||"ImJoy File Dialog",this.options.root=this.options.root||".",this.options.mode=this.options.mode||"single|multiple",this.file_tree_selection=null,new P.a(function(n,i){e.resolve=n,e.reject=i,e.root=e.options.root,e.listFiles(t.root,t.type,t.recursive).then(function(t){e.root=t.path,e.file_tree=t,e.$forceUpdate()})})}}},me=(i("xhcs"),Object(s.a)(pe,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"file-dialog"},[n("md-dialog",{attrs:{"md-active":t.show_,"md-click-outside-to-close":!1},on:{"update:mdActive":function(e){t.show_=e}}},[n("md-dialog-title",[t._v(t._s(this.options.title||"ImJoy File Dialog"))]),t._v(" "),n("md-dialog-content",[t.file_tree?n("ul",[n("file-item",{attrs:{model:t.file_tree,root:t.root,selected:t.file_tree_selection},on:{load:t.loadFile,select:t.fileTreeSelected,select_append:t.fileTreeSelectedAppend}})],1):t._e(),t._v(" "),t.file_tree_selection?n("p",[t._v("Selected: "+t._s(t.file_tree_selection))]):t._e()]),t._v(" "),n("md-dialog-actions",[n("md-button",{staticClass:"md-primary",on:{click:function(e){t.show_=!1,t.resolve(t.file_tree_selection)}}},[t._v("OK")]),t._v(" "),n("md-button",{staticClass:"md-primary",on:{click:function(e){t.show_=!1,t.reject()}}},[t._v("Cancel")])],1)],1)],1)},[],!1,null,"5a831765",null));me.options.__file="FileDialog.vue";var he=me.exports,fe={debug:!0,event_bus:new o.default,api:{}},ve={name:"app",data:function(){return{show_navbar:!0,store:this.$root.$data.store,api:this.$root.$data.store.api}},mounted:function(){var t=this;window.location.href.indexOf("navbar=0")>=0&&(this.show_navbar=!1),this.$nextTick(function(){t.store.api.show=t.show;var e=function(e){t.store.windowHeight=window.innerHeight,t.store.windowWidth=window.innerWidth,t.store.event_bus.$emit("resize",{height:t.store.windowHeight,width:t.store.windowWidth})};e(),document.addEventListener("orientationchange",window.onresize=e)})},methods:{show:function(t,e){this.snackbar_info=t,this.snackbar_duration=e||3e3,this.showSnackbar=!0}},watch:{}},ge=(i("CSik"),Object(s.a)(ve,function(){var t=this.$createElement,e=this._self._c||t;return e("md-app",{attrs:{id:"app","md-waterfall":"","md-mode":"fixed"}},[e("md-app-content",[e("router-view")],1)],1)},[],!1,null,null,null));ge.options.__file="App.vue";var _e=ge.exports,we=i("SFAN"),ye=i.n(we),be=i("DnPr"),ke=i.n(be);o.default.config.productionTip=!1,o.default.use(Nt.a),o.default.use(ke.a),o.default.component("vue-slider",Ft.a),o.default.component("navbar",Jt),o.default.component("faq",Ut),o.default.component("imjoy",Et),o.default.component("main-footer",Ht),o.default.component("about",Ot),o.default.component("whiteboard",Yt),o.default.component("joy",te),o.default.component("plugin-list",ie),o.default.component("plugin-editor",le),o.default.component("file-item",ue),o.default.component("file-dialog",he),o.default.component("grid-layout",ye.a.GridLayout),o.default.component("grid-item",ye.a.GridItem),o.default.component("monaco-editor",ae.a);o.default.filter("truncate",function(t,e,n){n=n||"...";var i=document.createElement("div");i.innerHTML=t;var o=i.textContent;return o.length>e?o.slice(0,e)+n:o}),new o.default({el:"#app",router:Rt,data:{store:fe,router:Rt},template:"<App/>",components:{App:_e}})},"O/K1":function(t,e){},PDwE:function(t,e){},PQcn:function(t,e){},QELy:function(t,e){},RAyX:function(t,e){},Rug9:function(t,e){},SFaC:function(t,e){},Sf3E:function(t,e){},SyUj:function(t,e){},UNEj:function(t,e){},V8Js:function(t,e){},Wi6a:function(t,e){},XNnT:function(t,e){},XQfL:function(t,e){},XdyD:function(t,e){},Xmi7:function(t,e){},Yjfx:function(t,e){},ZnPw:function(t,e,n){"use strict";var i=n("ivTg");n.n(i).a},adgO:function(t,e){},bxEs:function(t,e){},cs2Q:function(t,e){},dEK0:function(t,e){},dIB3:function(t,e){},eLUf:function(t,e){},fu2m:function(t,e){},giDI:function(t,e){},hUlH:function(t,e){},hZjZ:function(t,e,n){"use strict";var i=n("0Ab7");n.n(i).a},ivTg:function(t,e){},jPlm:function(t,e,n){"use strict";var i=n("C8ew");n.n(i).a},lLPU:function(t,e){},mASQ:function(t,e){},mJaV:function(t,e){},mfJA:function(t,e){},nEI8:function(t,e){},nJfC:function(t,e){},nbYx:function(t,e){},nhdz:function(t,e){},oZMw:function(t,e){},ow1S:function(t,e,n){"use strict";var i=n("yzvR");n.n(i).a},"pT/T":function(t,e){},q8Aj:function(t,e){},rJW0:function(t,e){},rWIB:function(t,e){},ruda:function(t,e,n){"use strict";var i=n("LhRv");n.n(i).a},rvYA:function(t,e){},s2Ue:function(t,e){},skPP:function(t,e){},stWb:function(t,e){},tSky:function(t,e,n){"use strict";var i=n("pT/T");n.n(i).a},urWN:function(t,e,n){"use strict";var i=n("eLUf");n.n(i).a},v0UZ:function(t,e,n){"use strict";var i=n("DCqN");n.n(i).a},vTna:function(t,e,n){"use strict";(function(t){n.d(e,"a",function(){return m});var i=n("C4MV"),o=n.n(i),a=n("mvHQ"),r=n.n(a),s=n("Xxa5"),l=n.n(s),c=n("exGp"),d=n.n(c),u=n("pFYg"),p=n.n(u);function m(t){var e=this==window?{}:this;if(t.modules)for(var n=0;n<t.modules.length;n++)m.loadModule(t.modules[n]);return m.Op.call(e,t),m.initReferences(e),null==e.previewOps&&(e.previewOps=!1),null==e.previewNumbers&&(e.previewNumbers=!1),e.activePreview=null,e.canPreview=function(t){return t=t.charAt(0).toUpperCase()+t.slice(1),e["preview"+t]&&!e.activePreview},e.createWidget(),e.container&&("string"==typeof e.container&&(e.container=document.body.querySelector(e.container)),e.container.appendChild(e.dom)),m.ui.init(e),m.modal.init(e),e}m.Op=function(t,e,n){var i=this;if(i._class_="Op",i.options=t,i.parent=e,i.top=i.parent?i.parent.top:i,i.type=t.type,i.type){var o=m.getTemplateByType(i.type);f(i,o)}if(f(i,i.options),e&&"object"==p()(e.onupdate)&&e.onupdate[i.id]&&(i.onupdate=e.onupdate[i.id]),i.children=[],i.addChild=function(t,e){return"object"==p()(i.onupdate)&&i.onupdate[t.id]&&(t.onupdate=i.onupdate[t.id]),"Op"!=t._class_&&(t=new m.Op(t,i,e)),i.children.push(t),t.id&&(i[t.id]=t),t},i.removeChild=function(t){v(i.children,t),t.kill()},i.onkill=i.onkill||function(){},i.kill=function(){for(i.dom&&i.dom.parentNode&&i.dom.parentNode.removeChild(i.dom),unwatch(i.data,c);i.children.length>0;)i.removeChild(i.children[0]);i.onkill(i)},void 0===i.placeholder&&(i.placeholder={}),"function"==typeof i.placeholder&&(i.placeholder=i.placeholder()),("object"!==p()(i.placeholder)||Array.isArray(i.placeholder))&&(i.placeholder={value:h(i.placeholder)}),i.placeholder.type||(i.placeholder.type=i.type),i.data=i.data||n,!i.data){e=i.parent;var a=i.dataID;e&&a?(e.data[a]||(e.data[a]=h(i.placeholder)),i.data=e.data[a]):i.data=h(i.placeholder)}i.getData=function(t){return i.data[t]},i.setData=function(t,e,n){s=!0,void 0===e?delete i.data[t]:i.data[t]=e,setTimeout(function(){s=!1},1),n||i.update()},i.switchData=function(t){unwatch(i.data,c),i.data=t,watch(i.data,c),i.onDataChange&&i.onDataChange(t)};var r,s=!1,c=function(t,e,n,o){s||i.onDataChange&&i.onDataChange()};watch(i.data,c),i.dom=null,i.initWidget=i.initWidget||function(){i.dom=document.createElement("span"),i.dom.innerHTML="[todo: '"+i.type+"' widget]"},i.createWidget=function(){return i.initWidget(i),i.dom},i.previewData=null,i.onexecute=i.onexecute||function(){console.log("no execute function found.")},i.execute=(r=d()(l.a.mark(function t(e,n){var o;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return o=n?h(n):i.previewData?h(i.previewData):h(i.data),i.children.forEach(function(t){var n=t.dataID;if(n){var i=t.get(e);o[n]=i}}),t.next=4,i.onexecute({op:i,target:e,data:o});case 4:return t.abrupt("return",t.sent);case 5:case"end":return t.stop()}},t,this)})),function(t,e){return r.apply(this,arguments)}),i.update=function(){if(i.parent&&i.parent.update(),i.onupdate&&"function"==typeof i.onupdate){var t;t=i.previewData?h(i.previewData):h(i.data),i.children.forEach(function(e){var n=e.dataID;if(n){var i=e.get({});t[n]=i}});i.onupdate({data:t})}},i.get_config=function(t){var e;return t=t||{},e=i.previewData?h(i.previewData):h(i.data),i.children.forEach(function(n){var i=n.dataID;if(i&&t){var o=n.get(t);e[i]=o}}),e},i.onget=i.onget||function(t){return t.data},i.get=function(t){var e=i.previewData?i.previewData:i.data;return e=h(e),i.onget({op:i,target:t,data:e})},i.init&&("string"==typeof i.init&&m.initializeWithString(i,i.init),"function"==typeof i.init&&i.init(i))},m.templates=[],m.add=function(t){var e=m.templates.filter(function(e){return void 0!==e.type&&void 0!==t.type&&e.type==t.type});if(e.length<=0)m.templates.push(t);else{for(var n=0;n<e.length;n++)v(m.templates,e[n]);m.templates.push(t)}},m.remove=function(t){var e=m.templates.filter(function(e){if(e.type==t)return!0});if(e.length>0)for(var n=0;n<e.length;n++)v(m.templates,e[n])},m.reset=function(){m.templates=[]},m.getTemplateByType=function(t){var e=m.templates.find(function(e){return e.type==t});if(!e)throw Error("No op template of type '"+t+"'!");return e},m.getTemplatesByTag=function(t){return m.templates.filter(function(e){return e.tags&&e.tags.indexOf(t)>=0})},m.modify=function(){var t,e,n;2==arguments.length?(t=arguments[0],n=arguments[1]):(t=arguments[0],e=arguments[1],n=arguments[2]);var i={},o=m.getTemplateByType(t);f(i,o);var a=n(o);f(i,a),e?o.type=e:v(m.templates,o),m.add(i)},m.initializeWithString=function(t,e){for(var n=[],i=e,o=-1,a=-1,r=0,s=0;s<i.length;s++){var l=i[s];if(0==r&&"{"==l&&(o=s),"{"==l&&r++,"}"==l&&r--,0==r&&"}"==l){a=s+1;var c=i.slice(o,a);c=(c=c.replace(/(\w+)\:/g,"'$1':")).replace(/\'/g,'"'),(c=JSON.parse(c)).dataID=c.dataID||c.id,n.push(c),i=i.substr(0,o)+"<span id='widget_"+c.id+"'></span>"+i.substr(a),s=0,o=-1,a=-1,r=0}}n.forEach(function(e){t.addChild(e)}),t.createWidget=function(){return t.dom=document.createElement("span"),t.dom.innerHTML=i,t.children.forEach(function(e){e.createWidget();var n="#widget_"+e.id,i=t.dom.querySelector(n);t.dom.replaceChild(e.dom,i)}),t.dom}},m.modules={},m.module=function(t,e){m.modules[t]=e},m.loadModule=function(t){var e=m.modules[t];if(!e)throw Error("There's no module called '"+t+"'!");e()},m.initReferences=function(t){var e=t.top.data;for(var n in e._references||(e._references={}),e._references){e._references[n].connected=0}},m.createReference=function(t,e,n){var i=t.top.data,o={id:b(i._references),tags:k(e),data:n,connected:0};return i._references[o.id]=o,o},m.getReferenceById=function(t,e){return t.top.data._references[e]},m.getReferencesByTag=function(t,e){var n=t.top.data,i=[];for(var o in n._references){var a=n._references[o];a.tags.indexOf(e)>=0&&i.push(a)}return i},m.connectReference=function(t,e){m.getReferenceById(t,e).connected++},m.disconnectReference=function(t,e){var n=m.getReferenceById(t,e);n.connected--,0==n.connected&&m.deleteReference(t,e)},m.deleteReference=function(t,e){var n=t.top.data;n._references[e];delete n._references[e]},m.saveToURL=function(t){var e=r()(t),n=O.compressToEncodedURIComponent(e);return window.location.origin+window.location.pathname+"?data="+n},m.loadFromURL=function(){var t=C("data"),e=O.decompressFromEncodedURIComponent(t);return e?JSON.parse(e):null},Math.TAU=2*Math.PI;var h=function(t){return JSON.parse(r()(t))},f=function(t,e){for(var n in e){var i=e[n];t[n]=i}},v=function(t,e){var n=t.indexOf(e);return!(n<0)&&(t.splice(n,1),!0)},g=function(t){t.addEventListener("paste",function(t){if(t.preventDefault(),t.clipboardData&&t.clipboardData.getData){var e=t.clipboardData.getData("text/plain");document.execCommand("insertHTML",!1,e)}else if(window.clipboardData&&window.clipboardData.getData){!function(t){var e,n;window.getSelection?(e=window.getSelection()).getRangeAt&&e.rangeCount&&((n=e.getRangeAt(0)).deleteContents(),n.insertNode(document.createTextNode(t))):document.selection&&document.selection.createRange&&(document.selection.createRange().text=t)}(e=window.clipboardData.getData("Text"))}})},_=function(t,e){var n=document.createRange();n.selectNodeContents(t),e&&n.collapse(!1);var i=window.getSelection();i.removeAllRanges();try{i.addRange(n)}catch(t){}},w=function(){window.getSelection().removeAllRanges()},y=function(t){""==t.innerText&&(t.innerHTML="&nbsp;",_(t)),t.innerHTML.search("<br>")>=0&&(t.innerHTML=t.innerHTML.replace(/(\<br\>)+/g,"&nbsp;"),_(t,!0))},b=function(t){var e,n=0;do{e="id"+n,n++}while(t[e]);return e},k=function(t){return Array.isArray(t)?t:[t]},C=function(t,e){e||(e=window.location.href),t=t.replace(/[\[\]]/g,"\\$&");var n=new RegExp("[?&]"+t+"(=([^&#]*)|&|#|$)").exec(e);return n?n[2]?decodeURIComponent(n[2].replace(/\+/g," ")):"":null};function x(t,e,n){var i,o,a,r,s,l,c,d;switch(1===arguments.length&&(e=t.s,n=t.v,t=t.h),l=n*(1-e),c=n*(1-(s=6*(t/=360)-(r=Math.floor(6*t)))*e),d=n*(1-(1-s)*e),r%6){case 0:i=n,o=d,a=l;break;case 1:i=c,o=n,a=l;break;case 2:i=l,o=n,a=d;break;case 3:i=l,o=c,a=n;break;case 4:i=d,o=l,a=n;break;case 5:i=n,o=l,a=c}return[Math.round(255*i),Math.round(255*o),Math.round(255*a)]}function P(t,e,n){1===arguments.length&&(e=t[1],n=t[2],t=t[0]);var i=x(t,e,n);return"rgb("+i[0]+","+i[1]+","+i[2]+")"}var j,D=0,E=[[0,.6,1],[30,.8,1],[210,.8,1],[260,.7,1],[310,.6,1]];j=function(){function t(){b=null;for(var t=0;t<y.length;t++)y[t]();y.length=0}var e={noMore:!1,useDirtyCheck:!1},n=[],i=[],a=[],r=!1;try{r=o.a&&Object.defineProperty({},"x",{})}catch(e){}var s=function(t){return t&&"[object Function]"=={}.toString.call(t)},l=function(t){return"[object Array]"===Object.prototype.toString.call(t)},c=function(t){return"[object Object]"==={}.toString.apply(t)},d=function(t,e){var n=[],i=[];if("string"!=typeof t&&"string"!=typeof e){if(l(t)&&e)for(var o=0;o<t.length;o++)void 0===e[o]&&n.push(o);else for(var o in t)t.hasOwnProperty(o)&&e&&void 0===e[o]&&n.push(o);if(l(e)&&t)for(var a=0;a<e.length;a++)void 0===t[a]&&i.push(a);else for(var a in e)e.hasOwnProperty(a)&&t&&void 0===t[a]&&i.push(a)}return{added:n,removed:i}},u=function(t){if(null==t||"object"!=(void 0===t?"undefined":p()(t)))return t;var e=t.constructor();for(var n in t)e[n]=t[n];return e},m=function(t,e,n){try{o()(t,e,{enumerable:!1,configurable:!0,writable:!1,value:n})}catch(i){t[e]=n}},h=function(t,e,n){i[i.length]={prop:e,object:t,orig:u(t[e]),callback:n}},f=function t(e,n,i,o){if("string"!=typeof e&&(e instanceof Object||l(e))){if(l(e)){if(j(e,"__watchall__",n,i),void 0===i||i>0)for(var a=0;a<e.length;a++)t(e[a],n,i,o)}else{var s=[];for(a in e)"$val"==a||!r&&"watchers"===a||Object.prototype.hasOwnProperty.call(e,a)&&s.push(a);v(e,s,n,i,o)}o&&L(e,"$$watchlengthsubjectroot",n,i)}},v=function(t,e,n,i,o){if("string"!=typeof t&&(t instanceof Object||l(t)))for(var a=0;a<e.length;a++){var r=e[a];g(t,r,n,i,o)}},g=function(t,e,n,i,o){"string"!=typeof t&&(t instanceof Object||l(t))&&(s(t[e])||(null!=t[e]&&(void 0===i||i>0)&&f(t[e],n,void 0!==i?i-1:i),j(t,e,n,i),o&&(void 0===i||i>0)&&L(t,e,n,i)))},_=function(t,e){if(!(t instanceof String)&&(t instanceof Object||l(t)))if(l(t)){for(var n=["__watchall__"],i=0;i<t.length;i++)n.push(i);w(t,n,e)}else{!function t(n){var i=[];for(var o in n)n.hasOwnProperty(o)&&(n[o]instanceof Object?t(n[o]):i.push(o));w(n,i,e)}(t)}},w=function(t,e,n){for(var i in e)e.hasOwnProperty(i)&&O(t,e[i],n)},y=[],b=null,k=function(){return b||(b=setTimeout(t)),b},C=function(t){null==b&&k(),y[y.length]=t},x=function(t,e,n,i){var o=null,a=-1,r=l(t);f(t,function(n,i,s,l){var c=k();if(a!==c&&(a=c,(o={type:"update"}).value=t,o.splices=null,C(function(){e.call(this,o),o=null})),r&&t===this&&null!==o){if("pop"===i||"shift"===i)s=[],l=[l];else if("push"===i||"unshift"===i)s=[s],l=[];else if("splice"!==i)return;o.splices||(o.splices=[]),o.splices[o.splices.length]={index:n,deleteCount:l?l.length:0,addedCount:s?s.length:0,added:s,deleted:l}}},1==n?void 0:0,i)},P=function(t,e,n,i,o){t&&e&&(g(t,e,function(t,e,a,r){var s={type:"update"};s.value=a,s.oldvalue=r,(i&&c(a)||l(a))&&x(a,n,i,o),n.call(this,s)},0),(i&&c(t[e])||l(t[e]))&&x(t[e],n,i,o))},j=function(t,n,i,a){var r=!1,s=l(t);t.watchers||(m(t,"watchers",{}),s&&$(t,function(e,i,o,r){if(T(t,e,i,o,r),0!==a&&o&&(c(o)||l(o))){var s,d,u,p,m=t.watchers[n];for((p=t.watchers.__watchall__)&&(m=m?m.concat(p):p),u=m?m.length:0,s=0;s<u;s++)if("splice"!==i)f(o,m[s],void 0===a?a:a-1);else for(d=0;d<o.length;d++)f(o[d],m[s],void 0===a?a:a-1)}})),t.watchers[n]||(t.watchers[n]=[],s||(r=!0));for(var d=0;d<t.watchers[n].length;d++)if(t.watchers[n][d]===i)return;if(t.watchers[n].push(i),r){var u=t[n],p=function(i,o){var r=u;if(u=i,0!==a&&t[n]&&(c(t[n])||l(t[n]))&&!t[n].watchers){var s,d=t.watchers[n].length;for(s=0;s<d;s++)f(t[n],t.watchers[n][s],void 0===a?a:a-1)}return I(t,n)?void W(t,n):void(e.noMore||r!==i&&(o?T(t,n,"set",i,r):D(t,n,"set",i,r),e.noMore=!1))};e.useDirtyCheck?h(t,n,p):function(t,e,n,i){try{Object.observe(t,function(t){t.forEach(function(t){t.name===e&&i(t.object[t.name])})})}catch(a){try{o()(t,e,{get:n,set:function(t){i.call(this,t,!0)},enumerable:!0,configurable:!0})}catch(o){try{Object.prototype.__defineGetter__.call(t,e,n),Object.prototype.__defineSetter__.call(t,e,function(t){i.call(this,t,!0)})}catch(n){h(t,e,i)}}}}(t,n,function(){return u},p)}},D=function t(e,n,i,o,a){if(void 0!==n){var r,s,l=e.watchers[n];(s=e.watchers.__watchall__)&&(l=l?l.concat(s):s),r=l?l.length:0;for(var c=0;c<r;c++)l[c].call(e,n,i,o,a)}else for(var n in e)e.hasOwnProperty(n)&&t(e,n,i,o,a)},E=["pop","push","reverse","shift","sort","slice","unshift","splice"],S=function(t,e,n,i){m(t,n,function(){var o,a,r,s,l=0;if("splice"===n){var c=arguments[0],d=c+arguments[1];for(r=t.slice(c,d),a=[],o=2;o<arguments.length;o++)a[o-2]=arguments[o];l=c}else a=arguments.length>0?arguments[0]:void 0;return s=e.apply(t,arguments),"slice"!==n&&("pop"===n?(r=s,l=t.length):"push"===n?l=t.length-1:"shift"===n?r=s:"unshift"!==n&&void 0===a&&(a=s),i.call(t,l,n,a,r)),s})},$=function(t,e){if(s(e)&&t&&!(t instanceof String)&&l(t))for(var n,i=E.length;i--;)S(t,t[n=E[i]],n,e)},O=function(t,e,n){if(e){if(t.watchers[e])if(void 0===n)delete t.watchers[e];else for(var i=0;i<t.watchers[e].length;i++){t.watchers[e][i]==n&&t.watchers[e].splice(i,1)}}else delete t.watchers;N(t,e,n),M(t,e)},I=function(t,e){return t.watchers&&(t.watchers.__wjs_suspend__||t.watchers["__wjs_suspend__"+e])},W=function(t,e){C(function(){delete t.watchers.__wjs_suspend__,delete t.watchers["__wjs_suspend__"+e]})},A=null,T=function(t,e,n,i,o){a[a.length]={obj:t,prop:e,mode:n,newval:i,oldval:o},null===A&&(A=setTimeout(U))},U=function(){var t=null;A=null;for(var e=0;e<a.length;e++)t=a[e],D(t.obj,t.prop,t.mode,t.newval,t.oldval);t&&(a=[],t=null)},R=function(t,e){var n,i=!0;if(t!==e)if(c(t)){for(n in t)if((r||"watchers"!==n)&&t[n]!==e[n]){i=!1;break}}else i=!1;return i},L=function(t,e,i,o){var a;a=u("$$watchlengthsubjectroot"===e?t:t[e]),n.push({obj:t,prop:e,actual:a,watcher:i,level:o})},N=function(t,e,i){for(var o=0;o<n.length;o++){var a=n[o];a.obj==t&&(e&&a.prop!=e||i&&a.watcher!=i||n.splice(o--,1))}},M=function(t,e){for(var n=0;n<i.length;n++){var o=i[n],a=o.object.watchers;o.object==t&&(!e||o.prop==e)&&a&&(!e||!a[e]||0==a[e].length)&&i.splice(n--,1)}};return setInterval(function(){for(var t=0;t<n.length;t++){var e=n[t];if("$$watchlengthsubjectroot"===e.prop)((o=d(e.obj,e.actual)).added.length||o.removed.length)&&(o.added.length&&v(e.obj,o.added,e.watcher,e.level-1,!0),e.watcher.call(e.obj,"root","differentattr",o,e.actual)),e.actual=u(e.obj);else{var o;if((o=d(e.obj[e.prop],e.actual)).added.length||o.removed.length){if(o.added.length)for(var a=0;a<e.obj.watchers[e.prop].length;a++)v(e.obj[e.prop],o.added,e.obj.watchers[e.prop][a],e.level-1,!0);D(e.obj,e.prop,"differentattr",o,e.actual)}e.actual=u(e.obj[e.prop])}}var r,s;if(i.length>0)for(t=0;t<i.length;t++)s=(r=i[t]).object[r.prop],R(r.orig,s)||(r.orig=u(s),r.callback(s))},50),e.watch=function(){s(arguments[1])?f.apply(this,arguments):l(arguments[1])?v.apply(this,arguments):g.apply(this,arguments)},e.unwatch=function(){s(arguments[1])?_.apply(this,arguments):l(arguments[1])?w.apply(this,arguments):O.apply(this,arguments)},e.callWatchers=D,e.suspend=function(t,e){if(t.watchers){var n="__wjs_suspend__"+(void 0!==e?e:"");t.watchers[n]=!0}},e.onChange=function(){(s(arguments[2])?P:x).apply(this,arguments)},e},"function"==typeof define&&n("nErl")?define(j):(window.WatchJS=j(),window.watch=window.WatchJS.watch,window.unwatch=window.WatchJS.unwatch,window.callWatchers=window.WatchJS.callWatchers);var S,$,O=function(){function t(t,e){if(!o[t]){o[t]={};for(var n=0;n<t.length;n++)o[t][t.charAt(n)]=n}return o[t][e]}var e=String.fromCharCode,n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",o={},a={compressToBase64:function(t){if(null==t)return"";var e=a._compress(t,6,function(t){return n.charAt(t)});switch(e.length%4){default:case 0:return e;case 1:return e+"===";case 2:return e+"==";case 3:return e+"="}},decompressFromBase64:function(e){return null==e?"":""==e?null:a._decompress(e.length,32,function(i){return t(n,e.charAt(i))})},compressToUTF16:function(t){return null==t?"":a._compress(t,15,function(t){return e(t+32)})+" "},decompressFromUTF16:function(t){return null==t?"":""==t?null:a._decompress(t.length,16384,function(e){return t.charCodeAt(e)-32})},compressToUint8Array:function(t){for(var e=a.compress(t),n=new Uint8Array(2*e.length),i=0,o=e.length;o>i;i++){var r=e.charCodeAt(i);n[2*i]=r>>>8,n[2*i+1]=r%256}return n},decompressFromUint8Array:function(t){if(null==t)return a.decompress(t);for(var n=new Array(t.length/2),i=0,o=n.length;o>i;i++)n[i]=256*t[2*i]+t[2*i+1];var r=[];return n.forEach(function(t){r.push(e(t))}),a.decompress(r.join(""))},compressToEncodedURIComponent:function(t){return null==t?"":a._compress(t,6,function(t){return i.charAt(t)})},decompressFromEncodedURIComponent:function(e){return null==e?"":""==e?null:(e=e.replace(/ /g,"+"),a._decompress(e.length,32,function(n){return t(i,e.charAt(n))}))},compress:function(t){return a._compress(t,16,function(t){return e(t)})},_compress:function(t,e,n){if(null==t)return"";var i,o,a,r={},s={},l="",c="",d="",u=2,p=3,m=2,h=[],f=0,v=0;for(a=0;a<t.length;a+=1)if(l=t.charAt(a),Object.prototype.hasOwnProperty.call(r,l)||(r[l]=p++,s[l]=!0),c=d+l,Object.prototype.hasOwnProperty.call(r,c))d=c;else{if(Object.prototype.hasOwnProperty.call(s,d)){if(d.charCodeAt(0)<256){for(i=0;m>i;i++)f<<=1,v==e-1?(v=0,h.push(n(f)),f=0):v++;for(o=d.charCodeAt(0),i=0;8>i;i++)f=f<<1|1&o,v==e-1?(v=0,h.push(n(f)),f=0):v++,o>>=1}else{for(o=1,i=0;m>i;i++)f=f<<1|o,v==e-1?(v=0,h.push(n(f)),f=0):v++,o=0;for(o=d.charCodeAt(0),i=0;16>i;i++)f=f<<1|1&o,v==e-1?(v=0,h.push(n(f)),f=0):v++,o>>=1}0==--u&&(u=Math.pow(2,m),m++),delete s[d]}else for(o=r[d],i=0;m>i;i++)f=f<<1|1&o,v==e-1?(v=0,h.push(n(f)),f=0):v++,o>>=1;0==--u&&(u=Math.pow(2,m),m++),r[c]=p++,d=String(l)}if(""!==d){if(Object.prototype.hasOwnProperty.call(s,d)){if(d.charCodeAt(0)<256){for(i=0;m>i;i++)f<<=1,v==e-1?(v=0,h.push(n(f)),f=0):v++;for(o=d.charCodeAt(0),i=0;8>i;i++)f=f<<1|1&o,v==e-1?(v=0,h.push(n(f)),f=0):v++,o>>=1}else{for(o=1,i=0;m>i;i++)f=f<<1|o,v==e-1?(v=0,h.push(n(f)),f=0):v++,o=0;for(o=d.charCodeAt(0),i=0;16>i;i++)f=f<<1|1&o,v==e-1?(v=0,h.push(n(f)),f=0):v++,o>>=1}0==--u&&(u=Math.pow(2,m),m++),delete s[d]}else for(o=r[d],i=0;m>i;i++)f=f<<1|1&o,v==e-1?(v=0,h.push(n(f)),f=0):v++,o>>=1;0==--u&&(u=Math.pow(2,m),m++)}for(o=2,i=0;m>i;i++)f=f<<1|1&o,v==e-1?(v=0,h.push(n(f)),f=0):v++,o>>=1;for(;;){if(f<<=1,v==e-1){h.push(n(f));break}v++}return h.join("")},decompress:function(t){return null==t?"":""==t?null:a._decompress(t.length,32768,function(e){return t.charCodeAt(e)})},_decompress:function(t,n,i){var o,a,r,s,l,c,d,u=[],p=4,m=4,h=3,f="",v=[],g={val:i(0),position:n,index:1};for(o=0;3>o;o+=1)u[o]=o;for(r=0,l=Math.pow(2,2),c=1;c!=l;)s=g.val&g.position,g.position>>=1,0==g.position&&(g.position=n,g.val=i(g.index++)),r|=(s>0?1:0)*c,c<<=1;switch(r){case 0:for(r=0,l=Math.pow(2,8),c=1;c!=l;)s=g.val&g.position,g.position>>=1,0==g.position&&(g.position=n,g.val=i(g.index++)),r|=(s>0?1:0)*c,c<<=1;d=e(r);break;case 1:for(r=0,l=Math.pow(2,16),c=1;c!=l;)s=g.val&g.position,g.position>>=1,0==g.position&&(g.position=n,g.val=i(g.index++)),r|=(s>0?1:0)*c,c<<=1;d=e(r);break;case 2:return""}for(u[3]=d,a=d,v.push(d);;){if(g.index>t)return"";for(r=0,l=Math.pow(2,h),c=1;c!=l;)s=g.val&g.position,g.position>>=1,0==g.position&&(g.position=n,g.val=i(g.index++)),r|=(s>0?1:0)*c,c<<=1;switch(d=r){case 0:for(r=0,l=Math.pow(2,8),c=1;c!=l;)s=g.val&g.position,g.position>>=1,0==g.position&&(g.position=n,g.val=i(g.index++)),r|=(s>0?1:0)*c,c<<=1;u[m++]=e(r),d=m-1,p--;break;case 1:for(r=0,l=Math.pow(2,16),c=1;c!=l;)s=g.val&g.position,g.position>>=1,0==g.position&&(g.position=n,g.val=i(g.index++)),r|=(s>0?1:0)*c,c<<=1;u[m++]=e(r),d=m-1,p--;break;case 2:return v.join("")}if(0==p&&(p=Math.pow(2,h),h++),u[d])f=u[d];else{if(d!==m)return null;f=a+a.charAt(0)}v.push(f),u[m++]=a+f.charAt(0),a=f,0==--p&&(p=Math.pow(2,h),h++)}}};return a}();"function"==typeof define&&n("nErl")&&define(function(){return O}),S={},m.ui=S,S.init=function(t){t.dom.classList.add("joy-master"),t.container.addEventListener("wheel",function(e){var n=e.deltaY;return t.container.scrollTop+=n,!1})},S.Button=function(t){var e=this,n=document.createElement("div");n.className="joy-button",e.dom=n,t.label=t.label||"",e.label=document.createElement("span"),n.appendChild(e.label),e.setLabel=function(t){e.label.innerHTML=t},e.setLabel(t.label),n.onclick=function(){t.onclick()},e.styles=t.styles||[];for(var i=0;i<e.styles.length;i++)n.classList.add(e.styles[i])},S.ChooserButton=function(t){var e=this;e.value=t.value,e.options=t.options,e.onchange=t.onchange,e.value||(e.value=e.options[0].value),S.Button.call(e,{label:void 0===t.staticLabel?"":t.staticLabel,onclick:function(){m.modal.Chooser({source:e.dom,options:e.options,onchange:function(t){e.value=t,n(),e.onchange(t)},position:t.position})},styles:t.styles});var n=function(){if(void 0===t.staticLabel){var n=e.options.find(function(t){return t.value==e.value}).label;e.setLabel(n)}};n()},S.Scrubber=function(t){var e=this,n=t.min,i=t.max;e.value=t.value;var o=document.createElement("div");o.className="joy-scrubber",e.dom=o,e.setLabel=function(t){o.innerHTML=t.toFixed(e.sigfigs)};var a,r,s=function(n){n=parseFloat(n.toFixed(e.sigfigs)),t.onchange(n)},l=!1,c=!1,d=0,u=function(n){l=!0,a=n.clientX,r=e.value,d=0,t.onstart&&t.onstart()},p=function(t){if(l){c=!0;var n=Math.pow(.1,e.sigfigs);n=parseFloat(n.toPrecision(1));var i=t.clientX-a;a=t.clientX;var o=Math.abs(i/10);o<1&&(o=1),o>3&&(o=3),d+=i*o;var u=Math.floor(d/2),p=r+u*n;p=m(p),e.value!=p&&(e.value=p,e.setLabel(p),s(p))}},m=function(t){return void 0!==n&&t<n&&(t=n),void 0!==i&&t>i&&(t=i),t},h=function(){l=!1,t.onstop&&t.onstop(),setTimeout(function(){c=!1},1)};o.addEventListener("mousedown",u),window.addEventListener("mousemove",p),window.addEventListener("mouseup",h),e.kill=function(){o.removeEventListener("mousedown",u),window.removeEventListener("mousemove",p),window.removeEventListener("mouseup",h)};var f,v=!1;o.onblur=function(){v&&(v=!1,o.contentEditable=!1,w(),k(o.innerText),e.value=b(),e.setLabel(e.value),s(e.value),t.onstop&&t.onstop())},g(o),(f=o).addEventListener("keypress",function(t){13===t.which&&(t.preventDefault(),f.blur())}),o.onclick=function(){c||(v=!0,o.contentEditable=!0,o.spellcheck=!1,_(o),t.onstart&&t.onstart())},o.oninput=function(t){if(v){var e=/[^0-9.\-]/g;o.innerText.match(e)&&(o.innerText=o.innerText.replace(e,"")),y(o),s(b())}};var b=function(){var t=parseFloat(o.innerText);return isNaN(t)&&(t=0),t=m(t)};e.sigfigs=0;var k=function(t){var n,i=(t=t.toString()).search(/\./);n=i>=0?t.length-1-i:0,e.sigfigs=n};k(e.value),e.setLabel(e.value)},S.String=function(t){var e=document.createElement("div");e.className="joy-string",this.dom=e;var n=document.createElement("span");n.contentEditable=!0,n.spellcheck=!1;var i=document.createElement("span"),o=document.createElement("span");i.innerHTML=t.prefix||"",o.innerHTML=t.suffix||"",e.appendChild(i),e.appendChild(n),e.appendChild(o),n.oninput=function(e){y(n);var i=n.innerText;t.onchange(i)},n.onfocus=function(){_(n)},n.onblur=function(){w()},g(n),n.onkeypress=function(t){return 13!=t.which||(n.blur(),!1)},this.setString=function(t){n.innerText=t,y(n)},this.setColor=function(t){t=function(t){return Array.isArray(t)&&(t=P(t[0],t[1],t[2])),t}(t),e.style.color=t,e.style.borderColor=t},t.color&&this.setColor(t.color),this.styles=t.styles||[];for(var a=0;a<this.styles.length;a++)e.classList.add(this.styles[a]);this.setString(t.value)},S.TextBox=function(t){var e,n=this;t.multiline?e=document.createElement("textarea"):(e=document.createElement("input")).type="text",t.placeholder&&(e.placeholder=t.placeholder),e.spellcheck=!1,e.className="joy-textbox",n.dom=e;var i=n.dom;t.readonly?(e.setAttribute("readonly",1),e.addEventListener("click",function(){n.select()})):e.oninput=function(n){t.onchange(e.value)},t.width&&(e.style.width="number"==typeof t.width?t.width+"px":t.width),n.getValue=function(){return e.value},n.setValue=function(t){e.value=t},n.select=function(){e.select()},n.styles=t.styles||[];for(var o=0;o<n.styles.length;o++)i.classList.add(n.styles[o]);t.value&&n.setValue(t.value),t.multiline&&(i.addEventListener("input",function(){this.style.height="auto",this.style.height=this.scrollHeight+"px"},!1),setTimeout(function(){i.setAttribute("style","height:"+i.scrollHeight+"px; overflow-y:hidden;")},1))},$={},m.modal=$,$.init=function(t){$.dom=document.createElement("div"),$.dom.id="joy-modal",document.body.appendChild($.dom),$.bg=document.createElement("div"),$.bg.id="joy-bg",$.bg.onclick=function(){$.currentUI.kill()},$.dom.appendChild($.bg),$.box=document.createElement("div"),$.box.id="joy-box",$.box.className="arrow_box",$.dom.appendChild($.box),$.dom.addEventListener("wheel",function(t){return"auto"==$.box.style.overflow||(t.preventDefault(),!1)})},$.show=function(t){$.dom.style.display="block",$.currentUI=t,$.box.appendChild(t.dom);var e=t.config.position||"below",n=$.box.getBoundingClientRect(),i=t.config.source.getBoundingClientRect(),o=$.bg.getBoundingClientRect();switch("below"==e&&(r=i.top+i.height+20)+n.height>document.body.clientHeight&&(e="left"),$.box.setAttribute("position",e),e){case"below":var a=i.left+i.width/2,r=i.top+i.height+20;a-=n.width/2;break;case"left":a=i.left-20,r=i.top+i.height/2,a-=n.width,r-=n.height/2}a<0&&(a=1),r+n.height>o.height&&(r=o.height-n.height-1),$.box.style.left=a+"px",$.box.style.top=r+"px",$.currentUI.config.onopen&&$.currentUI.config.onopen()},$.hide=function(){!function(t){for(;t.hasChildNodes();)t.removeChild(t.lastChild)}($.box),$.dom.style.display="none",$.currentUI.config.onclose&&$.currentUI.config.onclose()},$.Chooser=function(t){var e={};e.config=t;var n=document.createElement("div");n.className="joy-modal-chooser",e.dom=n;var i=document.createElement("div");n.appendChild(i),e.options=[],e.categories={};var o=function(t){var n=document.createElement("div");i.appendChild(n),e.categories[t]=n};e.populate=function(){for(var n=0;n<t.options.length;n++)(r=(i=t.options[n]).category)?e.categories[r]||o(r):e.categories._placeholder_||o("_placeholder_");for(n=0;n<t.options.length;n++){var i=t.options[n],a=document.createElement("div");a.innerHTML=i.label,i.color&&(a.style.color=i.color);var r=i.category||"_placeholder_";e.categories[r].appendChild(a),function(t){a.onclick=function(n){e.onchange(t.value),n.stopPropagation()}}(i)}},e.populate(),e.onchange=function(n){e.kill(),t.onchange(n)},e.kill=function(){$.hide()},$.show(e)},$.Color=function(t){var e={};e.config=t;var n=document.createElement("div");n.className="joy-modal-color",e.dom=n,t.value=t.value||[0,1,1],e.h=t.value[0],e.s=t.value[1],e.v=t.value[2],e.dom.style.width="195px",e.dom.style.height="170px";var i=document.createElement("canvas");i.id="joy-color-wheel";var o=i.getContext("2d");i.width=300,i.height=300,i.style.width=i.width/2+"px",i.style.height=i.height/2+"px",n.appendChild(i),i.style.top="10px",i.style.left="10px";var a=function(){var t=o;t.clearRect(0,0,t.canvas.width,t.canvas.height);for(var n=i.width,a=i.height,r=t.createImageData(n,a),s=r.data,l=n/2,c=a/2,d=n/2,u=d+2,p=0;p<n;p++)for(var m=0;m<a;m++){var h=p-l,f=m-c,v=Math.sqrt(h*h+f*f);if(v<u){v>=d&&(v=d);var g=Math.atan2(f,h),_=x(g=360*(g/Math.TAU+.5),v/=d,e.v),w=4*(p+m*n);s[w]=_[0],s[w+1]=_[1],s[w+2]=_[2],s[w+3]=255}}t.putImageData(r,0,0),t.save(),t.globalCompositeOperation="destination-in",t.beginPath(),t.fillStyle="#fff",t.arc(l,c,d,0,Math.TAU),t.fill(),t.restore()};a();var r=document.createElement("canvas");r.id="joy-color-value";var s=r.getContext("2d");r.width=30,r.height=300,r.style.width=r.width/2+"px",r.style.height=r.height/2+"px",n.appendChild(r),r.style.top="10px",r.style.right="10px";var l=function(){var t=s;t.clearRect(0,0,t.canvas.width,t.canvas.height);for(var n=r.width,i=r.height,o=t.createImageData(n,i),a=o.data,l=0;l<n;l++)for(var c=0;c<i;c++){var d=x(e.h,e.s,1-c/i),u=4*(l+c*n);a[u]=d[0],a[u+1]=d[1],a[u+2]=d[2],a[u+3]=255}t.putImageData(o,0,0)};l();var c=document.createElement("canvas");c.id="joy-color-picker";var d=c.getContext("2d");c.width=390,c.height=340,c.style.width=c.width/2+"px",c.style.height=c.height/2+"px",n.appendChild(c);var u,p=function(){var t,n,o=d;o.clearRect(0,0,o.canvas.width,o.canvas.height),o.fillStyle=P(e.h,e.s,e.v),o.strokeStyle="#fff",o.lineWidth=2;var a=20+i.width/2,s=20+i.height/2,l=e.h*(Math.TAU/360),c=e.s*(i.width/2);t=a-Math.cos(l)*c,n=s-Math.sin(l)*c,o.beginPath(),o.arc(t,n,15,0,Math.TAU),o.fill(),o.stroke(),t=20+i.width+20+r.width/2,n=20+r.height*(1-e.v),o.beginPath(),o.arc(t,n,15,0,Math.TAU),o.fill(),o.stroke()};p();var m=!1,h=function(t){if(t.target==c){var e=2*t.offsetX,n=2*t.offsetY;"hs"==u?f(e-=20,n-=20):(e-=20+i.width+20,v(e,n-=20)),y()}},f=function(t,n){var o=i.width/2,a=t-o,r=n-o,s=Math.atan2(r,a),c=Math.sqrt(a*a+r*r);(s=360*(s/Math.TAU+.5))<0&&(s=0),s>360&&(s=360),(c/=o)<0&&(c=0),c>1&&(c=1),e.h=s,e.s=c,l(),p()},v=function(t,n){e.v=1-n/r.height,e.v<0&&(e.v=0),e.v>1&&(e.v=1),a(),p()},g=function(t){m=!0,u=2*t.offsetX<20+i.width+10?"hs":"v",h(t)},_=function(t){m&&h(t)},w=function(){m=!1};c.addEventListener("mousedown",g),window.addEventListener("mousemove",_),window.addEventListener("mouseup",w);var y=function(){var n=[e.h,e.s,e.v];n[0]=parseFloat(n[0].toFixed(0)),n[1]=parseFloat(n[1].toFixed(2)),n[2]=parseFloat(n[2].toFixed(2)),t.onchange(n)};e.kill=function(){n.removeEventListener("mousedown",g),window.removeEventListener("mousemove",_),window.removeEventListener("mouseup",w),$.hide()},$.show(e)},m.add({type:"number",tags:["ui"],initWidget:function(t){var e=t.options,n=new m.ui.Scrubber({min:e.min,max:e.max,step:e.step,value:t.getData("value"),onstart:function(){t.top.activePreview=t},onstop:function(){t.top.activePreview=null},onchange:function(e){t.setData("value",e)}});t.dom=n.dom;var i=null;t.dom.onmouseenter=function(){if(t.top.canPreview("numbers")){t.previewData=h(t.data);var e=Math.abs(.05*t.data.value);0==e&&(e=1);var n=0;i=setInterval(function(){if(!t.top.canPreview("numbers"))return o();n+=Math.TAU/30/.25,t.previewData.value=t.data.value+Math.sin(n)*e,t.update(),n>Math.TAU&&o()},1e3/30)}};var o=function(){i&&clearInterval(i),t.previewData=null};t.dom.onmouseleave=o},onget:function(t){return t.data.value},placeholder:{value:3}}),m.add({type:"button",tags:["ui"],initWidget:function(t){var e=document.createElement("div");e.className="joy-save",t.dom=e,t.saveButton=new m.ui.Button({label:t.options.label||"--",onclick:function(){t.update()}}),e.appendChild(t.saveButton.dom)}}),m.add({type:"color",tags:["ui"],initWidget:function(t){var e=new m.ui.Button({label:"&nbsp;",onclick:function(){m.modal.Color({source:t.dom,value:t.getData("value"),onchange:function(e){t.setData("value",e),n()},onopen:function(){t.top.activePreview=t},onclose:function(){t.top.activePreview=null}})},styles:["joy-color"]});t.dom=e.dom;var n=function(){var n=t.getData("value");e.dom.style.background=P(n)};n();var i,o,a=null;t.dom.onmouseenter=function(){t.top.canPreview("numbers")&&(t.data.value[2],t.previewData=h(t.data),o=0,i=2/30*2,a=setInterval(function(){if(!t.top.canPreview("numbers"))return r();var e=t.previewData.value;e[2]+=i,e[2]>1&&(e[2]=1,i*=-1),e[2]<0&&(e[2]=0,i*=-1),t.update(),(o+=2/30)>=1&&r()},1e3/30))};var r=function(){a&&clearInterval(a),t.previewData=null,t.update()};t.dom.onmouseleave=r},onget:function(t){return P(t.data.value)},placeholder:function(){return[Math.floor(360*Math.random()),.8,1]}}),m.add({type:"choose",tags:["ui"],initWidget:function(t){for(var e=t.data,n=t.options,i=0;i<n.length;i++){var o=n[i];void 0!==o.label&&void 0!==o.value||(n[i]={label:o.toString(),value:o})}var a=new m.ui.ChooserButton({value:e.value,options:n,onchange:function(n){e.value=n,t.update()},styles:t.styles});t.dom=a.dom},onget:function(t){return t.data.value}}),m.add({type:"string",tags:["ui"],initWidget:function(t){var e=t.options;t.stringUI=new m.ui.String({prefix:e.prefix,suffix:e.suffix,color:e.color,value:t.getData("value"),onchange:function(e){t.setData("value",e)}}),t.dom=t.stringUI.dom,t.onDataChange=function(){var e=t.getData("value");t.stringUI.setString(e)}},onget:function(t){return t.data.value},placeholder:"???"}),m.add({type:"save",tags:["ui"],initWidget:function(t){var e=document.createElement("div");e.className="joy-save",t.dom=e,t.saveButton=new m.ui.Button({label:"save",onclick:function(){var e=m.saveToURL(t.top.data);t.url.setValue(e),t.url.select();e.length;t.info.innerHTML="P.S: you can shorten your link with <a href='http://tinyurl.com/' target='_blank'>TinyURL</a>!"}}),e.appendChild(t.saveButton.dom),t.url=new m.ui.TextBox({readonly:!0}),e.appendChild(t.url.dom),t.info=document.createElement("div"),t.info.id="joy-save-info",e.appendChild(t.info)}}),m.add({type:"ops",tags:["ui"],init:function(t){void 0!==t.resetVariables&&(t.data.resetVariables=t.resetVariables)},initWidget:function(t){var e=t.data.ops,n=document.createElement("div");n.className="joy-ops",t.dom=n;var i=document.createElement("list");i.id="joy-list",n.appendChild(i);var o=[{label:"Add op above",value:"op_above"},{label:"Add op below",value:"op_below"},{label:"Delete",value:"delete"}],a=function(n){var a=new m.ui.ChooserButton({position:"below",staticLabel:r(n),options:o,onchange:function(o){!function(n,o){var a=0;if("op_above"==o&&(a=-1),"op_below"==o&&(a=1),0!=a){var r=t.entries.indexOf(n);a>0&&(r+=1),m.modal.Chooser({position:"below",source:n.bullet.dom,options:u,onchange:function(e){d(e,r),t.update(),s()}})}"delete"==o&&(v(t.entries,n),v(e,n.opData),t.removeChild(n.op),i.removeChild(n.dom),t.update(),s())}(n,o)},styles:["joy-bullet"]});return a.dom.id="joy-bullet",a},r=function(e){for(var n,i=t.entries.indexOf(e)+1,o=0,a=t.parent;a;)"ops"==a.type&&o++,a=a.parent;switch(o%3){case 0:n=i;break;case 1:n=function(t){for(var e=0,n=1;t>=n;)e++,t-=n,n*=26;for(var i="",o=0;o<e;o++)i="abcdefghijklmnopqrstuvwxyz".charAt(t%26)+i,t=Math.floor(t/26);return i}(i);break;case 2:n=function(t){if(!+t)return NaN;for(var e=String(+t).split(""),n=["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM","","X","XX","XXX","XL","L","LX","LXX","LXXX","XC","","I","II","III","IV","V","VI","VII","VIII","IX"],i="",o=3;o--;)i=(n[+e.pop()+10*o]||"")+i;return(Array(+e.join("")+1).join("M")+i).toLowerCase()}(i)}return n},s=function(){for(var e=0;e<t.entries.length;e++){var n=t.entries[e],i=n.bullet,o=r(n);i.setLabel(o)}};t.entries=[];for(var l=function(e,o){var r={},s=document.createElement("div");void 0===o&&(o=t.entries.length),t.entries.splice(o,0,r),i.insertBefore(s,i.children[o]);var l=a(r),c=document.createElement("div");c.id="joy-bullet-container",s.appendChild(c),c.appendChild(l.dom);var d=t.addChild({type:e.type},e),u=d.createWidget();u.id="joy-widget",s.appendChild(u),r.dom=s,r.bullet=l,r.op=d,r.widget=u,r.opData=e;var p,m,f=function(e){var n=e.offsetY/l.dom.getBoundingClientRect().height;n<0&&(n=0),n>1&&(n=1),p._PREVIEW=n,t.update()};return c.onmouseenter=function(e){if(t.top.canPreview("ops")){t.top.activePreview=t,t.previewData=h(t.data);var i=t.entries.indexOf(r);p=t.previewData.ops[i],t.previewData.ops.splice(i+1,0,{STOP:!0}),f(e),m=document.createElement("style"),document.head.appendChild(m),m.sheet.insertRule(".joy-ops.joy-previewing > #joy-list > div:nth-child(n+"+(i+2)+") { opacity:0.1; }"),m.sheet.insertRule(".joy-ops.joy-previewing > div.joy-bullet { opacity:0.1; }"),n.classList.add("joy-previewing")}},c.onmousemove=function(e){t.previewData&&f(e)},c.onmouseleave=function(){t.previewData&&(t.previewData=null,t.top.activePreview=null,t.update(),document.head.removeChild(m),n.classList.remove("joy-previewing"))},r},c=0;c<e.length;c++)l(e[c]);var d=function(t,n){var i={type:t};void 0===n?e.push(i):e.splice(n,0,i);l(i,n)},u=[];if(t.onlyOps)for(c=0;c<t.onlyOps.length;c++){var p=t.onlyOps[c],f=m.getTemplateByType(p),g=f.tags.filter(function(t){return"op"!=t})[0];u.push({label:f.name,value:p,category:g})}else{var _=m.getTemplatesByTag("op");for(c=0;c<_.length;c++){var w=_[c];g=w.tags.filter(function(t){return"op"!=t})[0];u.push({label:w.name,value:w.type,category:g})}}var y=new m.ui.ChooserButton({staticLabel:"+",options:u,onchange:function(e){d(e),t.update()},styles:["joy-bullet"]});n.appendChild(y.dom)},onexecute:function(){var t=d()(l.a.mark(function t(e){var n,i,o,a;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e.target._variables||(e.target._variables={}),e.data.resetVariables&&(e.target._variables={}),n=0;case 3:if(!(n<e.data.ops.length)){t.next=30;break}if(!(i=e.data.ops[n]).STOP){t.next=7;break}return t.abrupt("return","STOP");case 7:return o=e.op.entries[n].op,t.next=10,o.execute(e.target,i);case 10:if(!(a=t.sent)||!a.target){t.next=15;break}e.target=a.target,t.next=27;break;case 15:if(!a||!a.error){t.next=20;break}return console.error("ops stopped with error: ",a),t.abrupt("return",a);case 20:if(!a||!a.stop){t.next=25;break}return console.log("ops interrupted at step ",n,a),t.abrupt("return",a);case 25:if("STOP"!=a){t.next=27;break}return t.abrupt("return",a);case 27:n++,t.next=3;break;case 30:return t.abrupt("return",e);case 31:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}(),placeholder:{ops:[],resetVariables:!0}}),m.module("instructions",function(){m.add({name:"Repeat the following...",type:"instructions/repeat",tags:["instructions","op"],init:"Repeat the following {id:'count', type:'number', min:1, placeholder:3} times: {id:'ops', type:'ops', resetVariables:false}",onexecute:function(){var t=d()(l.a.mark(function t(e){var n,i,o,a;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n=1,void 0!==e.data._PREVIEW&&(n=e.data._PREVIEW),i=Math.floor(e.data.count*n),o=0;case 4:if(!(o<i)){t.next=27;break}return t.next=7,e.op.ops.execute(e.target);case 7:if(!(a=t.sent)||!a.target){t.next=12;break}e.target=a.target,t.next=24;break;case 12:if(!a.error){t.next=17;break}return console.error("op stopped with error: ",a),t.abrupt("return",a);case 17:if(!a.stop){t.next=22;break}return console.log("op interrupted at step ",o,a),t.abrupt("return",a);case 22:if("STOP"!=a){t.next=24;break}return t.abrupt("return",a);case 24:o++,t.next=4;break;case 27:return t.abrupt("return",e);case 28:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()}),m.add({name:"// Write a note",type:"instructions/comment",tags:["instructions","op"],initWidget:function(t){t.dom=document.createElement("div"),t.box=new m.ui.TextBox({multiline:!0,placeholder:"// your notes here",value:t.getData("value"),onchange:function(e){t.setData("value",e)},styles:["box"]}),t.dom.appendChild(t.box.dom)}})}),m.add({type:"variableName",tags:["ui"],init:function(t){var e=t.variableType;t._createNewReference=function(){var n,i,o,a={value:(i=m.getReferencesByTag(t,e).map(function(t){return t.data.value}),o=0,i.forEach(function(t){var e;"variable"==t&&(e=1);var n=t.match(/variable\s(\d+)/);n&&(e=parseInt(n[1])),o<e&&(o=e)}),0==o?"variable":"variable "+(o+1)),color:(n=E[D],D=(D+1)%E.length,n)},r=m.createReference(t,e,a);t.setData("refID",r.id,!0),m.connectReference(t,r.id)};var n=t.getData("refID");if(n)m.connectReference(t,n);else{var i=m.getReferencesByTag(t,e);if(t.startWithExisting&&i.length>0)n=i[i.length-1].id,t.setData("refID",n,!0),m.connectReference(t,n);else t._createNewReference()}t._switchReference=function(e){var n=t.getData("refID");m.disconnectReference(t,n),t.setData("refID",e),m.connectReference(t,e)}},initWidget:function(t){t.dom=document.createElement("span");var e=t.getData("refID"),n=m.getReferenceById(t,e).data,i=t.addChild({type:"string",prefix:"[",suffix:"]",color:n.color},n),o=i.createWidget();t.dom.appendChild(o);var a=i.onDataChange;i.onDataChange=function(){a();var t=i.getData("color");i.stringUI.setColor(t)};var r=t.variableType;t.noChooser||(t.dom.onclick=function(){var e=[],n=m.getReferencesByTag(t,r),o=t.getData("refID");n.forEach(function(t){if(t.id!=o){var n=t.data.color;n=P(n[0],n[1],n[2]),e.push({label:"["+t.data.value+"]",value:t.id,color:n})}}),e.push({category:"meta",label:"(+new)",value:"NEW"}),e.push({category:"meta",label:"(change color)",value:"CHANGE_COLOR"}),m.modal.Chooser({source:t.dom,options:e,onchange:function(e){if("CHANGE_COLOR"==e)m.modal.Color({source:t.dom,value:i.getData("color"),onchange:function(t){i.setData("color",t),i.stringUI.setColor(t)}});else{if("NEW"==e){var n=t.getData("refID");m.disconnectReference(t,n),t._createNewReference(),t.update()}else t._switchReference(e);var o=t.getData("refID"),a=m.getReferenceById(t,o);i.switchData(a.data)}}})})},onget:function(t){var e=t.data.refID;return m.getReferenceById(t.op,e).data.value},onkill:function(t){var e=t.getData("refID");m.disconnectReference(t,e)}}),m.module("math",function(){m.modify("number","number_raw",function(t){return{init:function(t){if(!t.noVariables){var e=t.getData("value");"number"==typeof e&&(t.setData("value",void 0,!0),t.setData("chain",[{type:"number_raw",min:t.min,max:t.max,step:t.step,value:e}],!0)),t._makeNewChainOp=function(e,n){var i,o=e.type;switch(o){case"number_raw":i=t.addChild({type:o,min:e.min,max:e.max,step:e.step},e);break;case"variableName":i=t.addChild({type:o,variableType:"number",noChooser:!0},e);break;case"choose":i=t.addChild({type:o,options:[{label:"+",value:"+"},{label:"-",value:"-"},{label:"&times;",value:"*"},{label:"&divide;",value:"/"}],styles:["joy-math"]},e)}var a=t.getData("chain");return void 0!==n?(t.chainOps.splice(n,0,i),a.splice(n,0,e)):(t.chainOps.push(i),a.push(e)),i},t.chainOps=[];var n=t.getData("chain"),i=h(n);n.splice(0,n.length);for(var o=0;o<i.length;o++)t._makeNewChainOp(i[o]);t._replaceChainOp=function(e,n){var i=t._deleteChainOp(e),o=t._makeNewChainOp(n,i);return t.update(),o},t._deleteChainOp=function(e){var n=t.chainOps.indexOf(e);return v(t.chainOps,e),t.removeChild(e),t.getData("chain").splice(n,1),n}}},initWidget:function(e){if(e.noVariables)t.initWidget(e);else{e.dom=document.createElement("span"),e.dom.className="joy-number";e._chainEntries=[],e._makeChainEntry=function(t,i){var o,a,r=document.createElement("span");if(t.createWidget(),r.appendChild(t.dom),"choose"!=t.type){var s,l=new m.ui.Button({onclick:function(){n(s)},styles:["joy-more"]});r.appendChild(l.dom)}if(void 0!==i)if(i<e.dom.childNodes.length){var c=e.dom.childNodes[i];e.dom.insertBefore(r,c)}else e.dom.appendChild(r);else e.dom.appendChild(r);"choose"!=t.type&&((o=t).dom.addEventListener("mousedown",function(){a=+new Date}),o.dom.addEventListener("mouseup",function(){+new Date-a<500&&function(t){var n=[];if("number_raw"!=t.type){var i=e.placeholder.value;"number"==typeof i&&n.push({label:i,value:{type:"number_raw",value:i}})}var o,a=m.getReferencesByTag(e,"number");"variableName"==t.type&&(o=t.getData("refID")),a.forEach(function(t){if(t.id!=o){var e=t.data.color;e=P(e[0],e[1],e[2]),n.push({label:"["+t.data.value+"]",value:{type:"variableName",refID:t.id},color:e})}}),n.length>0&&m.modal.Chooser({source:t.dom,options:n,onchange:function(n){var i=e._replaceChainOp(t,n);e._replaceChainEntry(t,i)}})}(o)})),s={widget:r,op:t},void 0!==i?e._chainEntries.splice(i,0,s):e._chainEntries.push(s)},e._deleteChainEntry=function(t){var n=e._chainEntries.find(function(e){return e.op==t}),i=e._chainEntries.indexOf(n),o=n.widget;return e.dom.removeChild(o),v(e._chainEntries,n),i},e._replaceChainEntry=function(t,n){var i=e._deleteChainEntry(t);e._makeChainEntry(n,i)};for(var n=function(t){var n=t.widget.innerText,i=[{label:n+" + 2",value:"+"},{label:n+" - 2",value:"-"},{label:n+" &times; 2",value:"*"},{label:n+" &divide; 2",value:"/"}],o=e._chainEntries.indexOf(t);if(e._chainEntries.length>1){var a,r;a=0==o?o+1:o-1;var s=e._chainEntries[a].widget.innerText;r=0==o?n+" "+s:s+" "+n;var l=[o,a].sort();i.push({category:"meta",label:"(delete ‚Äú"+r+"‚Äù)",value:l})}m.modal.Chooser({source:t.widget,options:i,onchange:function(n){if("string"==typeof n){var i=e._chainEntries.indexOf(t);i++;var o=e._makeNewChainOp({type:"choose",value:n},i);e._makeChainEntry(o,i),i++;var a=e._makeNewChainOp({type:"number_raw",value:2},i);e._makeChainEntry(a,i)}else for(var r=n,s=r.length-1;s>=0;s--){var l=r[s],c=e._chainEntries[l].op;e._deleteChainOp(c),e._deleteChainEntry(c)}e.update()}})},i=0;i<e.chainOps.length;i++){var o=e.chainOps[i];e._makeChainEntry(o)}}},onget:function(e){if(e.op.noVariables)return t.onget(e);for(var n=[],i=0;i<e.data.chain.length;i+=2){var o,a=e.op.chainOps[i];switch(a.type){case"number_raw":o=a.get(e.target);break;case"variableName":o=e.target._variables[a.get(e.target)]}if(i>0){var r=e.op.chainOps[i-1].get();n.push(r)}n.push(o)}for(i=1;i<n.length;i+=2){if("*"==(r=n[i])||"/"==r){var s=n[i-1],l=n[i+1];c="*"==r?s*l:s/l,n.splice(i-1,3,c),i-=2}}for(i=1;i<n.length;i+=2){if("+"==(r=n[i])||"-"==r){var c;s=n[i-1],l=n[i+1];c="+"==r?s+l:s-l,n.splice(i-1,3,c),i-=2}}return n[0]}}}),m.add({name:"Set [number]",type:"math/set",tags:["math","op"],init:"Set {id:'varname', type:'variableName', variableType:'number'} to {id:'value', type:'number'}",onexecute:function(t){t.target._variables[t.data.varname]=t.data.value}}),m.add({name:"Do math to [number]",type:"math/operation",tags:["math","op"],init:r()({id:"operation",type:"choose",placeholder:"+",options:[{label:"+ Increase",value:"+"},{label:"- Decrease",value:"-"},{label:"&times; Multiply",value:"*"},{label:"&divide; Divide",value:"/"}]})+" {id:'varname', type:'variableName', variableType:'number', startWithExisting:true} by {id:'value', type:'number'}",onexecute:function(t){var e=t.target._variables,n=t.data.varname;switch(void 0===e[n]&&(e[n]=0),t.data.operation){case"+":e[n]+=t.data.value;break;case"-":e[n]-=t.data.value;break;case"*":e[n]*=t.data.value;break;case"/":e[n]/=t.data.value}}}),m.add({name:"If [math] then...",type:"math/if",tags:["math","op"],init:"If {id:'value1', type:'number'} {id:'test', type:'choose', options:['<','‚â§','=','‚â•','>'], placeholder:'='} {id:'value2', type:'number'}, then: {id:'ops', type:'ops', resetVariables:false}",onexecute:function(t){var e,n=t.data.value1,i=t.data.value2;switch(t.data.test){case"<":e=n<i;break;case"‚â§":e=n<=i;break;case"=":e=n==i;break;case"‚â•":e=n>=i;break;case">":e=n>i}if(e){var o=t.op.ops.execute(t.target);if("STOP"==o)return o}}})}),m.module("random",function(){m.add({name:"With a X% chance...",type:"random/if",tags:["random","op"],init:"With a {id:'chance', type:'number', min:0, max:100, placeholder:50}% chance, do:{id:'ops', type:'ops', resetVariables:false}",onexecute:function(t){var e=t.data.chance/100;if(Math.random()<e){var n=t.op.ops.execute(t.target);if("STOP"==n)return n}}}),m.add({name:"Set random [number]",type:"random/set",tags:["random","op"],init:"Set {id:'varname', type:'variableName', variableType:'number'} to a random {id:'numtype', type:'choose', options:['number','integer'], placeholder:'number'} between {id:'min', type:'number', placeholder:1} and {id:'max', type:'number', placeholder:100}",onexecute:function(t){var e,n=t.target._variables,i=t.data.varname,o=t.data.min,a=t.data.max,r=Math.min(o,a),s=Math.max(o,a);e="integer"==t.data.numtype?r+Math.floor(Math.random()*(s-r+1)):r+Math.random()*(s-r),n[i]=e}})})}).call(e,n("f1Eh")(t))},vbFt:function(t,e,n){"use strict";var i=n("XNnT");n.n(i).a},vqOK:function(t,e){},"wW7/":function(t,e){},xhcs:function(t,e,n){"use strict";var i=n("q8Aj");n.n(i).a},xmfc:function(t,e){},ysfb:function(t,e){},yzvR:function(t,e){},"z6/S":function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.27bcd982f97721e2c092.js.map